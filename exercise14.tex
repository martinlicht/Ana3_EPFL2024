\documentclass[11pt]{article}
% \def\hidesolutions{}
\input{header}
\begin{document}
\exsheet{14}{19}{December} % parameters are the number of the session and the day








%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%   EXERCISE 1                           %%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{exercise}
    Given the following functions over an interval $[0,1)$, 
    \begin{enumerate}[label=(\alph*)]
        \item $f(x) = x$
        \item $g(x) = x^2$
        \item $h(x) = e^x$
        \item $s(x) = sin(\pi x)$
    \end{enumerate}
    sketch their extension to 
    \begin{itemize}
        \item a periodic function with period $1$,
        \item an even periodic function with period $2$,
        \item an odd periodic function with period $2$.
    \end{itemize}
    State the formulas for the even and odd $2$-periodic extensions over the interval $[-1,1]$.
\end{exercise}

\begin{solution}
    We begin with these plots:
    \begin{center}
        \begin{tabular}{cc} % 2x2 matrix structure
            \begin{tikzpicture}[scale=0.6]
                \draw[->] (-2,0)--(2,0) node[right]{$x$};
                \draw[->] (0,-3)--(0,3) node[above]{$y$};
                \draw[domain=-2:-1,smooth,variable=\x,blue] plot({\x},{\x+2});
                \draw[domain=-1:0,smooth,variable=\x,blue] plot({\x},{\x+1});
                \draw[domain=0:1,smooth,variable=\x,blue] plot({\x},{\x});
                \draw[domain=1:2,smooth,variable=\x,blue] plot({\x},{\x-1});
                \node[blue,above right] at (0.5,0.5) {$f(x)=x$};
            \end{tikzpicture}
            &
            \begin{tikzpicture}[scale=0.6]
                \draw[->] (-2,0)--(2,0) node[right]{$x$};
                \draw[->] (0,-3)--(0,3) node[above]{$y$};
                \draw[domain=-2:-1,smooth,variable=\x,red] plot({\x},{(\x+2)*(\x+2)});
                \draw[domain=-1:0,smooth,variable=\x,red] plot({\x},{(\x+1)*(\x+1)});
                \draw[domain=0:1,smooth,variable=\x,red] plot({\x},{\x*\x});
                \draw[domain=1:2,smooth,variable=\x,red] plot({\x},{(\x-1)*(\x-1)});
                \node[red,above] at (0.5,0.5) {$g(x)=x^2$};
            \end{tikzpicture}
            \\
            \begin{tikzpicture}[scale=0.6]
                \draw[->] (-2,0)--(2,0) node[right]{$x$};
                \draw[->] (0,-3)--(0,3) node[above]{$y$};
                \draw[domain=-2:-1,smooth,variable=\x,green] plot({\x},{exp(\x+2)});
                \draw[domain=-1:0,smooth,variable=\x,green] plot({\x},{exp(\x+1)});
                \draw[domain=0:1,smooth,variable=\x,green] plot({\x},{exp(\x)});
                \draw[domain=1:2,smooth,variable=\x,green] plot({\x},{exp(\x-1)});
                \node[green,above right] at (0.5,1.5) {$h(x)=e^x$};
            \end{tikzpicture}
            &
            \begin{tikzpicture}[scale=0.6]
                \draw[->] (-2,0)--(2,0) node[right]{$x$};
                \draw[->] (0,-3)--(0,3) node[above]{$y$};
                \draw[domain=-2:-1,smooth,variable=\x,orange] plot({\x},{sin(3.14159*(\x+2) r)});
                \draw[domain=-1:0,smooth,variable=\x,orange] plot({\x},{sin(3.14159*(\x+1) r)});
                \draw[domain=0:1,smooth,variable=\x,orange] plot({\x},{sin(3.14159*\x r)});
                \draw[domain=1:2,smooth,variable=\x,orange] plot({\x},{sin(3.14159*(\x-1) r)});
                \node[orange,above] at (0.5,0.5) {$s(x)=\sin(\pi x)$};
            \end{tikzpicture}
        \end{tabular}
    \end{center}
    
    \begin{center}
        \begin{tabular}{cc} % 2x2 matrix structure
            \begin{tikzpicture}[scale=0.6]
                \draw[->] (-2,0)--(2,0) node[right]{$x$};
                \draw[->] (0,-3)--(0,3) node[above]{$y$};
                \draw[domain=-1:1,smooth,variable=\x,blue] plot({\x},{abs(\x)});
                \draw[domain=1:2,smooth,variable=\x,blue] plot({\x},{abs(\x-2)});
                \draw[domain=-2:-1,smooth,variable=\x,blue] plot({\x},{abs(\x+2)});
                \node[blue,above right] at (0.5,0.5) {$f_{\text{even}}(x)=|x|$};
            \end{tikzpicture}
            &
            \begin{tikzpicture}[scale=0.6]
                \draw[->] (-2,0)--(2,0) node[right]{$x$};
                \draw[->] (0,-3)--(0,3) node[above]{$y$};
                \draw[domain=-1:1,smooth,variable=\x,red] plot({\x},{\x*\x});
                \draw[domain=1:2,smooth,variable=\x,red] plot({\x},{abs(\x-2)*abs(\x-2)});
                \draw[domain=-2:-1,smooth,variable=\x,red] plot({\x},{abs(\x+2)*abs(\x+2)});
                \node[red,above] at (0.5,0.5) {$g_{\text{even}}(x)=x^2$};
            \end{tikzpicture}
            \\
            \begin{tikzpicture}[scale=0.6]
                \draw[->] (-2,0)--(2,0) node[right]{$x$};
                \draw[->] (0,-3)--(0,3) node[above]{$y$};
                \draw[domain=-1:1,smooth,variable=\x,green] plot({\x},{exp(abs(\x))});
                \draw[domain=1:2,smooth,variable=\x,green] plot({\x},{exp(abs(\x-2))});
                \draw[domain=-2:-1,smooth,variable=\x,green] plot({\x},{exp(abs(\x+2))});
                \node[green,above right] at (0.5,1.5) {$h_{\text{even}}(x)=e^{|x|}$};
            \end{tikzpicture}
            &
            \begin{tikzpicture}[scale=0.6]
                \draw[->] (-2,0)--(2,0) node[right]{$x$};
                \draw[->] (0,-3)--(0,3) node[above]{$y$};
                \draw[domain=-1:1,smooth,variable=\x,orange] plot({\x},{sin(3.14159*abs(\x) r)});
                \draw[domain=1:2,smooth,variable=\x,orange] plot({\x},{sin(3.14159*abs(\x-2) r)});
                \draw[domain=-2:-1,smooth,variable=\x,orange] plot({\x},{sin(3.14159*abs(\x+2) r)});
                \node[orange,above] at (0.5,0.5) {$s_{\text{even}}(x)=\sin(\pi|x|)$};
            \end{tikzpicture}
        \end{tabular}
    \end{center}

    \begin{center}
        \begin{tabular}{cc} % 2x2 matrix structure
            \begin{tikzpicture}[scale=0.6]
                \draw[->] (-2,0)--(2,0) node[right]{$x$};
                \draw[->] (0,-3)--(0,3) node[above]{$y$};
                \draw[domain=-1:1,smooth,variable=\x,blue] plot({\x},{\x});
                \draw[domain=1:2,smooth,variable=\x,blue] plot({\x},{\x-2});
                \draw[domain=-2:-1,smooth,variable=\x,blue] plot({\x},{\x+2});
                \node[blue,above right] at (0.5,0.5) {$f_{\text{odd}}(x)=x$};
            \end{tikzpicture}
            &
            \begin{tikzpicture}[scale=0.6]
                \draw[->] (-2,0)--(2,0) node[right]{$x$};
                \draw[->] (0,-3)--(0,3) node[above]{$y$};
                \draw[domain=-2:-1,smooth,variable=\x,red] plot({\x}, {(\x+2)*(\x+2)});
                \draw[domain=-1: 0,smooth,variable=\x,red] plot({\x},-{\x*\x});
                \draw[domain= 0: 1,smooth,variable=\x,red] plot({\x}, {\x*\x});
                \draw[domain= 1: 2,smooth,variable=\x,red] plot({\x},-{(\x-2)*(\x-2)});
                \node[red,above] at (0.5,0.5) {$g_{\text{odd}}(x)$};
            \end{tikzpicture}
            \\
            \begin{tikzpicture}[scale=0.6]
                \draw[->] (-2,0)--(2,0) node[right]{$x$};
                \draw[->] (0,-3)--(0,3) node[above]{$y$};
                \draw[domain=-2:-1,smooth,variable=\x,green] plot({\x}, {exp( \x+2)});
                \draw[domain=-1: 0,smooth,variable=\x,green] plot({\x},-{exp(-\x  )});
                \draw[domain= 0: 1,smooth,variable=\x,green] plot({\x}, {exp( \x  )});
                \draw[domain= 1: 2,smooth,variable=\x,green] plot({\x},-{exp(-\x+2)});
                \node[green,above right] at (0.5,1.5) {$h_{\text{odd}}(x)=e^x$};
            \end{tikzpicture}
            &
            \begin{tikzpicture}[scale=0.6]
                \draw[->] (-2,0)--(2,0) node[right]{$x$};
                \draw[->] (0,-3)--(0,3) node[above]{$y$};
                \draw[domain=-2:2,smooth,variable=\x,orange] plot({\x},{sin(3.14159*\x r)});
                \node[orange,above] at (0.5,0.5) {$s_{\text{odd}}(x)=\sin(\pi x)$};
            \end{tikzpicture}
        \end{tabular}
    \end{center}
    We state the formulas for the even and odd extensions of period $2$.
    Over \([-1,1]\), define the even extensions:
    \begin{align*}
        f_{\text{even}}(x) &= |x|, 
        \\
        g_{\text{even}}(x) &= x^2,
        \\
        h_{\text{even}}(x) &= e^{|x|}, 
        \\
        s_{\text{even}}(x) &= |\sin(\pi x)|,
    \end{align*}
    and we define the odd extensions:
    \begin{align*}
        f_{\text{odd}}(x) &= x, 
        \\
        g_{\text{odd}}(x) &= \begin{cases}
        x^2 & x \in [0,1) \\
        -(-x)^2 = -x^2 & x \in [-1,0)
        \end{cases}
        \\
        h_{\text{odd}}(x) &= \begin{cases}
        e^x & x \in [0,1) \\
        -e^{-x} & x \in [-1,0)
        \end{cases}, 
        \\
        s_{\text{odd}}(x) &= \sin(\pi x).
    \end{align*}
\end{solution}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%   EXERCISE 2                           %%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{exercise}
    Consider the function 
    \begin{align*}
        f : [0,1] \to \bbR, \quad x \mapsto x^{3}.
    \end{align*}
    Extend this to an odd function with period $T = 2$. Sketch the graph of that function from $-2$ to $2$.
    Compute its Fourier coefficients in standard form. Compute the complex Fourier coefficients.
\end{exercise}
\begin{solution}
    We first sketch the odd extensions of that function:
    \begin{center}
    \begin{tikzpicture}[scale=0.6]
        \draw[->] (-2,0)--(2,0) node[right]{$x$};
        \draw[->] (0,-3)--(0,3) node[above]{$y$};
        % g(x) = x^3, odd extension
        \draw[domain=-2:-1,smooth,variable=\x,red] plot({\x}, {(\x+2)*(\x+2)*(\x+2)});
        \draw[domain=-1: 0,smooth,variable=\x,red] plot({\x}, {\x*\x*\x});
        \draw[domain= 0: 1,smooth,variable=\x,red] plot({\x}, {\x*\x*\x});
        \draw[domain= 1: 2,smooth,variable=\x,red] plot({\x}, {(\x-2)*(\x-2)*(\x-2)});

        \node[red,above] at (0.5,0.5) {$g_{\text{odd}}(x)$};
    \end{tikzpicture}
    \end{center}
    The odd extension of period 2 is given by
    \begin{align*}
        f_{\text{odd}}(x) = x^3, \quad x \in [-1,1].
    \end{align*}
    For the Fourier coefficients in standard form, we note that $a_n = 0, n \in \mathbb{N}$ since the function is odd by construction. For the sine-terms, we have
    \begin{align*}
        b_n = \int_{-1}^1 f_{\text{odd}}(x) \sin(\pi n x) dx = 2 \int_{0}^1 x^3 \sin(\pi n x) dx = \frac{2(-1)^n (\pi^2 n^2 - 6)}{\pi^3 n^3}.
    \end{align*}
    For the complex Fourier coefficients, we find for $n \in \mathbb{N}$:
    \begin{align*}
        c_0 &= a_0 = 0,
        \\
        c_n &= \frac 1 2 (a_n - i b_n) = \frac{i (-1)^{n+1} (\pi^2 n^2 - 6)}{\pi^3 n^3},
        \\
        c_{-n} &= \frac 1 2 (a_n + i b_n) = \frac{i(-1)^n(\pi^2 n^2 - 6)}{\pi^3 n^3}.
    \end{align*}
    
\end{solution}







%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%   EXERCISE 3                           %%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{exercise}
    Suppose that
    \begin{align*}
        f(x) = \left\{\begin{array}{cc} x+1 & \text{ if $-1 < x < 0$ }, \\  1-x & \text{ if $ 0 < x < 1$ }, \\  0 & \text{ otherwise. } \end{array}\right.
        \qquad 
        g(x) = \left\{\begin{array}{cc} \frac 1 2 & \text{ if $-1 < x < 1$ }, \\ 0 & \text{ otherwise. } \end{array}\right.
        \qquad 
        h(x) = |x|
        .
    \end{align*}
    Compute the convolutions $u(x) = (f \star g)(x)$ and $v(x) = (g \star g)(x)$ and $w(x) = (g \star h)(x)$.
\end{exercise}
\begin{solution}
    We can compute these convolutions via direct computations or by results from Fourier analysis.
    \begin{itemize}
        \item 
        This first one is the most difficult one.
        We can write 
        \begin{align}
            ( f \star g )(x) = \int_{x-1}^{x+1} f(x).
        \end{align}
        We think of this as a subinterval $[x-1,x+1]$ that moves over the real line, 
        and we integrate $f$ over this subinterval. 
        Since $f$ change its behavior three different times, the integral in the definition of $f \star g$ above will also change its behavior several times, depending on $x$.
        
        We therefore use a case distinction. 
        \begin{enumerate}
            \item If $x < -2$, the integral is just over the region where $f$ equals zero,
            and so $( f \star g )(x) = 0$.
            \item If $-2 < x < -1$, then we only need to integrate $f$ over $[-1,x+1] \subseteq [-1,0]$. We find 
            \begin{align}
                ...
            \end{align}
            \item If $-1 < x < 0$, then we integrate $f$ over $[-1,0] \cup [0,x+1] \subseteq [-1,1]$. We find 
            \begin{align}
                ...
            \end{align}
            \item If $0 < x < 1$, then we integrate $f$ over $[x-1,0] \cup [0,1] \subseteq [-1,1]$. We find 
            \begin{align}
                ...
            \end{align}
            \item If $1 < x < 2$, then we integrate $f$ over $[x-1,1] \subseteq [0,1]$. We find 
            \begin{align}
                ...
            \end{align}
            \item Lastly, if $2 < x$, the integral is just over the region where $f$ equals zero, 
            and so $( f \star g )(x) = 0$.
        \end{enumerate}


        
        \item 
        Note that
        \begin{align*}
            \hat{f}(\omega) &= \frac{1}{\sqrt{2 \pi}} \left(\frac{\sin(\omega / 2)}{\omega / 2}\right),
            \\
            \hat{g}(\omega) &= \frac{1}{\sqrt{2 \pi}} \frac{\sin(\omega)}{\omega}.
        \end{align*}
        Using the Convolution Theorem, we find
        \begin{align*}
            \hat{v}(\omega) = \sqrt{2 \pi}(\hat g (\omega))^2 = \hat f(2 \omega)
        \end{align*}
        Using the Modulation Theorem, we find
        \begin{align*}
            v(x) &= \frac 1 2 \mathcal{F}^{-1}(2 \hat f(2 \omega)) = \frac 1 2 f(\frac x 2)\\
                &= \frac 1 4 \begin{cases}
                    2 + x,& -2 \leq x < 0,\\
                    2 - x,& 0 \leq x < 2.
                \end{cases}
        \end{align*}
        \item 
        We first observe 
        \begin{align}
            ( g \star h )(x) = \frac 1 2 \int_{x-1}^{x+1} |y| dy.
        \end{align}
        From here, we make a case distinction. 
        If $0 < x-1$, which means $1 < x$, then 
        \begin{align}
            ( g \star h )(x) = - \frac 1 2 \int_{x-1}^{x+1} y dy = -x.
        \end{align}
        If $x+1 < 0$, which means $x < -1$, then 
        \begin{align}
            ( g \star h )(x) =   \frac 1 2 \int_{x-1}^{x+1} y dy =  x.
        \end{align}
        The case $x-1 < 0 < x+1$, which is $-1 < x < 1$, is more demanding. We split 
        \begin{align}
            ( g \star h )(x) 
            &= 
            \frac 1 2 \int_{x-1}^{  0} -y dy
            +
            \frac 1 2 \int_{  0}^{x+1}  y dy
            \\&
            =
            \frac 1 2 \left[ -\frac 1 2 y^{2}\right]_{y=x-1}^{y=  0}
            +
            \frac 1 2 \left[  \frac 1 2 y^{2}\right]_{y=  0}^{y=x+1}
            \\&
            =
            \frac 1 4 (x-1)^{2} 
            +
            \frac 1 4 (x+1)^{2} 
            =
            \frac 1 2 x^2 + \frac 1 2
            .
        \end{align}
        Note: if you plot this function, it will look like a moving average of $|x|$ that has been smoothed around $x=0$.
    \end{itemize}
\end{solution}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%   EXERCISE 4                           %%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{exercise}
    Suppose that $f(x) = x^2$ and that
    \begin{align*}
        g(x) = \left\{\begin{array}{cc} \frac 1 2 & \text{ if $-1 < x < 1$ }, \\ 0 & \text{ otherwise. } \end{array}\right.
        \qquad 
        h(x) = \left\{\begin{array}{cc} e^{-x} & \text{ if $x > 0$ }, \\ 0 & \text{ otherwise. } \end{array}\right.
    \end{align*}
    Compute the convolutions $u(x) = (f \star g)(x)$ and $v(x) = (f \star h)(x)$ .
\end{exercise}

\begin{solution}
    We find by direct computation:
    \begin{align*}
        (f \star g)(x) = (g \star f)(x) = \frac 1 2 \int_{-1}^1 (x - y)^2 dy = x^2 + \frac 1 3.
    \end{align*}   
    Similarly,
    \begin{align*}
        (f \star h)(x) 
        = 
        \int_{0}^\infty (x - y)^2 e^{-y} dy 
        = 
        \int_{0}^\infty (y - x)^2 e^{-y} dy 
        .
    \end{align*}
    We proceed here with integration by parts: first, 
    \begin{align*}
        \int_{0}^\infty (y - x)^2 e^{-y} dy 
        &=
        \left[ - (y - x)^2 e^{-y} \right]_{y=0}^{y=\infty}
        -
        \int_{0}^\infty (-1)2(y - x) e^{-y} dy 
        \\
        &=
        x^2 
        +
        2
        \int_{0}^\infty (y - x) e^{-y} dy 
        .
    \end{align*}
    Then, 
    \begin{align*}
        \int_{0}^\infty (y - x) e^{-y} dy 
        &=
        \left[ - (y - x) e^{-y} \right]_{y=0}^{y=\infty}
        -
        \int_{0}^\infty (-1) e^{-y} dy 
        \\
        &=
        -x 
        +
        \int_{0}^\infty e^{-y} dy 
        .
    \end{align*}
    Lastly,
    \begin{align*}
        \int_{0}^\infty e^{-y} dy = \left[ - e^{-y} \right]_{y=0}^{y=\infty} = 1
        .
    \end{align*}
    Thus, in total, we obtain 
    \begin{align*}
        (f \star h)(x) 
        =
        x^{2} + 2 \left( -x + 1 \right) = x^{2} - 2 x + 2.
    \end{align*}
\end{solution}










%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%   EXERCISE 5                           %%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{exercise}
    We have discussed solutions to the differential equation 
    \begin{align*}
        - \Delta u(x) + k^2 u(x) = e^{-|x|}, \quad x \in \mathbb R.
    \end{align*}
    \begin{itemize}
        \item 
        Verify that, in the case $k=1$, we have a solution 
        \begin{align*}
            u(x) = \frac 1 2 (1+|x|) e^{-|x|} 
        \end{align*}
        Verify that every function of the form 
        \begin{align*}
            v(x) = \frac 1 2 (1+|x|) e^{-|x|} + c_1 e^{-x} + c_2 e^{x} 
        \end{align*}
        is a solution. For which values of $c_1$ and $c_2$ does the function decay towards zero as $x$ goes to $\pm \infty$?
        %
        \item 
        Verify that, in the case $k \neq 1$, we have a solution 
        \begin{align*}
            u(x) = - \frac{ e^{-k|x|} }{ k (k^2-1) } + \frac{ e^{-|x|} }{ k^2-1 }
        \end{align*}
        Verify that every function of the form 
        \begin{align*}
            v(x) = - \frac{ e^{-k|x|} }{ k (k^2-1) } + \frac{ e^{-|x|} }{ k^2-1 } + c_1 e^{-kx} + c_2 e^{kx} 
        \end{align*}        
        is a solution.
    \end{itemize}
\end{exercise}
\begin{solution}
    We first note that the Fourier transform of $e^{-|x|}$ is given by
    \begin{align*}
        \mathcal F(e^{-|x|})(\omega) = \sqrt{\frac{2}{\pi}} \frac{1}{1+\omega^2}.
    \end{align*}
    Therefore, if $u(x)$ is a solution, then its Fourier transform $\hat u(\omega)$ satisfies
    \begin{align*}
        (\omega^2 + k^2) \hat u(\omega) = \sqrt{\frac{2}{\pi}} \frac{1}{1+\omega^2}.
    \end{align*}
    Therefore, if $k = 1$, then
    \begin{align*}
        \hat u(\omega) &= \sqrt{\frac{2}{\pi}} \frac{1}{(1+\omega^2)^2}\\
                    &= \mathcal{F}^{-1}(\frac{1}{2}(1 + |x|) e^{-|x|}).
    \end{align*}
    The last step can be seen from the results in the lecture.
    Thus, it is clear that $u(x) = \frac 1 2 (1+|x|) e^{-|x|}$ is a solution. Furthermore, it is clear that
    $c_1 \exp(-x)$ and $c_2 \exp(x)$ are solutions to the homogeneous problem, i.e. the one with a vanishing right-hand side.
    However, for $c_1$ and $c_2$ to ensure that the solution decays towards zero as $x$ goes to $\pm \infty$, we need to have $c_1 = c_2 = 0$.

    For the case $k \neq 1$, note that
    \begin{align*}
        \mathcal{F}(e^{-k|x|})(\omega) = \sqrt{\frac{2}{\pi}} \frac{k}{k^2 + \omega^2}.
    \end{align*}
    Therefore, the Fourier transform of the solution $u(x)$ satisfies
    \begin{align*}
        (\omega^2 + k^2) \hat u(\omega) &= \sqrt{\frac{2}{\pi}} (k^2 + \omega^2) \left[ \frac{-1}{(k^2 + \omega^2)(k^2 - 1)} + \frac{1}{(\omega^2 + 1)(k^2 - 1)} \right]
        \\
        &= \sqrt{\frac{2}{\pi}} (k^2 + \omega^2) \left[ \frac{k^2 -1}{(\omega^2 + 1)(k^2 - 1)(k^2 + \omega^2)} \right]
        \\
        &= \sqrt{\frac{2}{\pi}} \frac{1}{(1 + \omega^2)},
    \end{align*}
    as desired. The argument for the general solution is the same as for the case $k=1$.
\end{solution}







%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%   EXERCISE 6                           %%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{exercise}
    We want to find a solution to the boundary value problem 
    \begin{gather*}
        - \Delta u(x) + k^2 u(x) = x, \quad 0 < x < L,
        \\
        u(0) = 0, \quad u(L) = 0.
    \end{gather*}
    \begin{itemize}
        \item Extend the right-hand side $f(x) = x$ to an odd function with period $2L$ and compute its Fourier coefficients.
        \item Using these coefficients, find the Fourier series of the solution $u$. Verify that the boundary condition $u(0) = u(L) = 0$ is satisfied.
    \end{itemize}
\end{exercise}
\begin{solution}
    \begin{itemize}
        \item The odd extension of period 2 is simply given by
        \begin{align*}
            f_{\mathrm{odd}}(x) = x, \quad x \in [-L,L].
        \end{align*}
        \item 
        Since $f_{\mathrm{odd}}$ is odd by construction, we have
        \begin{align*}
            f_{\mathrm{odd}}(x) = \sum_{n=1}^{\infty} f_n \sin(\frac{n \pi x}{L}),
        \end{align*}
        with
        \begin{align*}
            f_n = \frac{2}{L} \int_{0}^{L} x \sin(\frac{n \pi x}{L}) dx = -\frac{L}{\pi n}.
        \end{align*}
        \item For the solution, we make a sine ansatz $u(x) = \sum_{n=1}^{\infty} u_n \sin(\frac{n \pi x}{L})$ since the right-hand side does not contain any cosine terms.
        Then, the PDE can be written in terms of the Fourier coefficients as
        \begin{align*}
            \left [k^2 + \left(\frac{2 \pi n}{L} \right)^2 \right]u_n = -\frac{L}{\pi n}, & & \forall n \in \mathbb{N}.
        \end{align*}
        Therefore, the solution is given by
        \begin{align*}
            u_n = -\frac{L}{\pi n \left[k^2 + \left(\frac{2 \pi}{L}n \right)^2\right]}.
        \end{align*}
        Note that the boundary conditions are satisfied.
    \end{itemize}

\end{solution}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%   EXERCISE 7                           %%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{exercise}[Fun with Neumann boundary conditions]
    Consider the Poisson problem with \textit{Neumann boundary conditions} over the interval $[a,b] = [0,1]$: 
    \begin{gather*}
        - u''(x) + k^2 u(x) = x - \frac 1 2, \quad a < x < b,
        \\
        u'(a) = 0, \quad u'(b) = 0,
    \end{gather*}
    for some $k \geq 0$.
    \begin{enumerate}[label=(\alph*)]
        \item
        Extend $f(x) = x - \frac 1 2$ to an \textit{even} function over the real line with period $2$.
        \item 
        Compute the Fourier coefficients of that even extension of $f$.
        \item 
        Find the Fourier series of a function that satisfies the above differential equation.
    \end{enumerate}
\end{exercise}
\begin{solution}
    \begin{itemize}
        \item The even extension of period 2 is given by $f_{\text{even}}(x) = |x| - \frac 1 2, x \in [-1, 1]$.
        \item Since $f_{\text{even}}$ is even by construction, we only have cosine terms, i.e.
        \begin{align*}
            f_{\text{even}}(x) = \frac{f_0}{2} + \sum_{n=1}^{\infty} f_n \cos(\pi n x),
        \end{align*}
        with
        \begin{align*}
            f_0 = \frac{1}{2} \int_{-1}^{1} (|x| - \frac 1 2) dx = \int_{-1}^1 (x - \frac 1 2) dx = 0,
        \end{align*}
        and
        \begin{align*}
            f_n = 2 \int_{0}^{1} (x- \frac 1 2) \cos(\pi n x) dx = \frac{2}{\pi^2 n^2}\left( (-1)^n - 1 \right).
        \end{align*}
        \item For the solution, we make a cosine ansatz $u(x) = \sum_{n=1}^{\infty} u_n \cos(\pi n x)$ because the right-hand side does not contain any sine terms.
        Then, the PDE can be written in terms of the Fourier coefficients as
        \begin{align*}
            u_0 &= 0,
            \\
            \left [k^2 + \pi^2 n^2 \right]u_n &= \frac{2}{\pi^2 n^2}\left( (-1)^n - 1 \right), & & \forall n \in \mathbb{N}.
        \end{align*}
        Therefore, the solution is given by 
        \begin{align*}
            u(x) = \sum_{n=1}^{\infty} \frac{2}{\pi^2 n^2 \left[k^2 + \pi^2 n^2 \right]}\left( (-1)^n - 1 \right) \cos(\pi n x).
        \end{align*}
        Note that the boundary conditions are satisfied.
    \end{itemize}
\end{solution}




















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%   EXERCISE 8                           %%%%%%%%%%%
%%%%%                                        %%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{exercise}[Fun with periodic boundary conditions]
    Consider the Poisson problem with \textit{periodic boundary conditions} over the interval $[a,b] = [0,1]$: 
    \begin{gather*}
        - u''(x) + k^2 u(x) = x - \frac 1 2, \quad a < x < b,
        \\
        u(a) = u(b),
    \end{gather*}
    for some $k \geq 0$.
    \begin{enumerate}[label=(\alph*)]
        \item
        Extend $f(x) = x - \frac 1 2$ to a $1$-periodic function over the real line.
        \item 
        Compute the Fourier coefficients of that extension of $f$.
        \item 
        Find the Fourier series of a function that satisfies the above differential equation.
    \end{enumerate}
\end{exercise}
\begin{solution}
    \begin{enumerate}
        \item The $1$-periodic extension is simply given by $f_{\text{per}}(x) = x - \frac 1 2, x \in [0, 1]$ with periodic continuation.
        \item For the Fourier coefficients, we note that $f_{\text{per}}$ is odd around $x = \frac 1 2$, so we only have sine terms, i.e.
        \begin{align*}
            f_{\text{per}}(x) = \sum_{n=1}^{\infty} f_n \sin(2 \pi n x),
        \end{align*}
        with
        \begin{align*}
            f_n = 2 \int_{0}^{1} (x- \frac 1 2) \sin(2 \pi n x) dx = - \frac{1}{2\pi n}.
        \end{align*}
        \item We make a sine ansatz for the solution: $u(x) = \sum_{n=1}^{\infty} u_n \sin(2 \pi n x)$.
        Then, the PDE can be written in terms of the Fourier coefficients as
        \begin{align*}
            \left [k^2 + (2 \pi n)^2 \right]u_n = -\frac{1}{2\pi n}, & & \forall n \in \mathbb{N}.
        \end{align*}
        Therefore, the solution is given by
        \begin{align*}
            u(x) = \sum_{n=1}^{\infty} \frac{-1}{2\pi n \left[k^2 + (2 \pi n)^2 \right]} \sin(2 \pi n x).
        \end{align*}
        Note that the periodic boundary conditions are satisfied.
    \end{enumerate}
\end{solution}



% \begin{exercise}
% \end{exercise}
% \begin{solution}     
% \end{solution}
% 
% \begin{exercise}
% \end{exercise}
% \begin{solution}     
% \end{solution}

\end{document}

\begin{exercise}
    Find the Laplace transform $F(z)$ of 
    \begin{align*}
        f : \bbR_{0}^{+} \to \bbR, \quad t \mapsto t^{2}.
    \end{align*}
\end{exercise}
\begin{solution}     
    We compute 
    \begin{align*}
        F(z)&=\int_0^{\infty} t^2 e^{-z t} d t=\left[-\frac{t^2}{z} e^{-z t}\right]_0^{\infty}+\int_0^{\infty} \frac{2 t}{z} e^{-z t} d t \\ &=\left[\frac{2 t}{-z^2} e^{-z t}\right]_0^{\infty}+\int_0^{\infty} \frac{2}{z^2} e^{-z t} d t \\ &=\left[-\frac{2}{z^3} e^{-z t}\right]_0^{\infty} \\ &=0+\frac{2}{z^3} \\ &=\frac{2}{z^3}
        .
    \end{align*}
    Hence 
    \begin{align*}
        F(z)=\frac{2}{z^3} \quad \text { for } \mathrm{R}(z)>0.
    \end{align*}
\end{solution}

\begin{exercise}[Fun with Neumann boundary conditions 2]
    Suppose we have got a Poisson problem with Neumann boundary conditions over the interval $[a,b] = [0,1]$. 
    \begin{gather*}
        - u''(x) = f(x), \quad a < x < b,
        \\
        u'(a) = h_a, \quad u'(b) = h_b.
    \end{gather*}
    We need the compatibility condition 
    \begin{gather*}
        \int_a^b f(x) dx + ( h_b - h_a ) = 0.
    \end{gather*}
    \begin{enumerate}[label=(\alph*)]
        \item
        Find a constant function $c^f : [a,b] \to \bbR$ such that $f - c_f$ has integral zero.
        \item
        Use this to split up the original problem into two subproblems: 
        one with homogeneous boundary conditions, one with constant right-hand side, such that both problems satisfy the compatibility condition.
    \end{enumerate}
\end{exercise}
\begin{solution}     
\end{solution}



