\documentclass[11pt]{article}
% \def\hidesolutions{}
\input{header}
\begin{document}
\exsheet{9}{14}{November} % parameters are the number of the session and the day

\begin{exercise}
    Compute the Fourier coefficients of the function $f$ that has period $T = 2\pi$ and satisfies
    \[
        f(x) = \left\{\begin{array}{ll} 1 & 0 \leq x < \pi \\ 0 & \pi < x \leq 2\pi \end{array}\right.
    \]
\end{exercise}
\begin{solution}     
    We notice that the period $T$ equals $T = 2\pi$. 
    We have defined the first coefficient to be just the average:
    \begin{align*}
        a_0 
        &= 
        \frac{1}{2\pi} \int_0^{2\pi} f(x) \, dx 
        = 
        \frac{1}{2\pi} \int_0^\pi \, dx  = \frac 1 2
        .
    \end{align*}
    For the other coefficients, we use the formulas from the lecture:
    \begin{align*}
        a_n 
        &= 
        \frac{2}{2\pi} \int_0^{2\pi} f(x) \cos\left(\frac{2\pi n x}{T}\right) \, dx 
        \\&= 
        \frac{2}{2\pi} \int_0^\pi \cos\left(\frac{2\pi n x}{T}\right) \, dx 
        \\
        &= 
        \frac{2}{2\pi} \left[ \frac{T}{2\pi n} \sin\left(\frac{2\pi n x}{T}\right) \right]_{x=0}^{x=\pi}
        \\&= 
        \frac{2}{2\pi} \frac{T}{2\pi n} \left( \sin\left(\frac{2\pi n \pi}{T}\right) - \sin(0) \right) 
        \\&= 
        \frac{2}{2\pi} \frac{2\pi}{2\pi n} \left( \sin\left(n \pi \right) - \sin(0) \right) 
        \\&= 
        0
    \end{align*}
    because $\sin$ equals zero at integer multiples of $\pi$.
    For the sine mode coefficients, we calculate similarly:
    \begin{align*}
        b_n 
        &= 
        \frac{2}{2\pi}
        \int_0^{2\pi} f(x) \sin(nx) \, dx 
        \\
        &= 
        \frac{1}{\pi}
        \int_0^\pi \sin(nx) \, dx 
        \\
        &= 
        \frac{1}{\pi}
        \left[-\frac{\cos(nx)}{n} \right]_{x=0}^{x=\pi} 
        \\
        &= 
        -
        \frac{1}{\pi}
        \frac{1}{n} \left[ \cos(n\pi) - \cos(0) \right] 
        \\
        &= 
        -
        \frac{1}{n\pi}
        \left[ (-1)^n - 1 \right] 
        \\
        &= 
        \frac{1}{n\pi}
        \begin{cases}
            0 & \text{if } n \text{ is even} 
            \\
            2 & \text{if } n \text{ is odd}
        \end{cases}
    \end{align*}
    Thus we find $a_0 = 1$ and $a_1 = a_2 = \dots = 0$,
    and either $b_n = 0$ if $n$ is even and $b_n = \frac{2}{n\pi}$ if $n$ is odd. 
\end{solution}


\begin{exercise}
    Compute the Fourier coefficients of the following functions, which have period $T = 1$ and have the given values over the interval $[0,1)$:
    \begin{itemize}
     \item 
     \[
        f(x) = x^{2}
     \]
     \item 
     \[
        g(x) = (1-x)x
     \]
     \item 
     \[
        h(x) = |\sin( 2 \pi x )|
     \]
     %
    \end{itemize}
\end{exercise}
\begin{solution}     
    \begin{itemize}
        \item 
        To compute the Fourier coefficients of $f(x) = x^2$ over the interval $[0,1)$ with a period of $1$, use the formulas from the lecture:
        \[
            a_0 = \int_{0}^{1} f(x) dx  = \int_{0}^{1} x^2 dx  = \left[ \frac{x^3}{3} \right]_{0}^{1} = \frac 1 3.
        \]
        For other coefficients, we apply integration by parts twice, and we use that $\sin$ vanishes at multiples of $\pi$:
        \begin{align*}
            a_n 
            &
            = 
            \frac{2}{T}
            \int_{0}^{1} x^2 \cos(2\pi n x) dx
            \\&
            =
            \frac{2}{T}
            \left[ x^2 \frac{ \sin(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            -
            \frac{2}{T}
            \int_{0}^{1} \frac{ 2x \sin(2\pi n x) }{ 2\pi n } dx
            \\&
            =
            \frac{2}{T}
            \left[ x^2 \frac{ \sin(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            -
            \frac{4}{T}
            \int_{0}^{1} x \frac{ \sin(2\pi n x) }{ 2\pi n } dx
            \\&
            =
            \frac{2}{T}
            \left[ x^2 \frac{ \sin(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            -
            \frac{4}{T}
            \left[ x \frac{ -\cos(2\pi n x) }{ 4\pi^2 n^2 } \right]_{x=0}^{x=1}
            +
            \frac{4}{T}
            \int_{0}^{1} \frac{ -\cos(2\pi n x) }{ 4\pi^2 n^2 } dx
            \\&
            =
            \frac{2}{T}
            \left[ x^2 \frac{ \sin(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            -
            \frac{4}{T}
            \left[ x \frac{ -\cos(2\pi n x) }{ 4\pi^2 n^2 } \right]_{x=0}^{x=1}
            +
            \frac{4}{T}
            \left[ \frac{ -\sin(2\pi n x) }{ 8\pi^3 n^3 } \right]_{x=0}^{x=1}
            \\&
            = 
            \frac{1}{\pi^2 n^2}
        \end{align*}
        \begin{align*}
            b_n 
            &
            = 
            \frac{2}{T}
            \int_{0}^{1} x^2 \sin(2\pi n x) dx
            \\&
            =
            \frac{2}{T}
            \left[- x^2 \frac{ \cos(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{2}{T}
            \int_{0}^{1} \frac{ 2x \cos(2\pi n x) }{ 2\pi n } dx
            \\&
            =
            \frac{2}{T}
            \left[- x^2 \frac{ \cos(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{4}{T}
            \int_{0}^{1} \frac{ x \cos(2\pi n x) }{ 2\pi n } dx
            \\&
            =
            \frac{2}{T}
            \left[ -x^2 \frac{ \cos(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{4}{T}
            \left[ x \frac{ \sin(2\pi n x) }{ 4\pi^2 n^2 } \right]_{x=0}^{x=1}
            -
            \frac{4}{T}
            \int_{0}^{1} \frac{ \sin(2\pi n x) }{ 4\pi^2 n^2 } dx
            \\&
            =
            \frac{2}{T}
            \left[ -x^2 \frac{ \cos(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{4}{T}
            \left[ x \frac{ \sin(2\pi n x) }{ 4\pi^2 n^2 } \right]_{x=0}^{x=1}
            +
            \frac{4}{T}
            \left[ \frac{ \cos(2\pi n x) }{ 8\pi^3 n^3 } \right]_{x=0}^{x=1}
            \\&
            = 
            -\frac{2}{T}\frac{1}{2\pi n} + \frac{4}{T}\frac{1}{8\pi^3n^3} -  \frac{4}{T}\frac{1}{8\pi^3n^3} = -\frac{1}{\pi n}
        \end{align*}
        \item 
        We notice that the function $g(x) = (1-x)x$ can be written $g(x) = x - f(x)$ over the interval $[0,1)$. 
        In other words, $g$ is the difference of the sawtooth function (which equals $x$ over $[0,1)$ and repeats with period $T=1$),
        and the periodic function $f(x)$ seen earlier.
        
        We will only need to determine the Fourier coefficients of $\tilde{g}(x) = x$ since we already computed the Fourier coefficients of $f(x)$. 
        We calculate the average 
        \[
            a_0^{\tilde g} = \int_{0}^{1} \tilde{g}(x) dx  = \int_{0}^{1} x dx  = \left[ \frac{x^2}{2} \right]_{0}^{1} = \frac 1 2.
        \]
        We calculate 
        \begin{align*}
            a_n^{\tilde g} 
            &
            = 
            \frac{2}{T}
            \int_{0}^{1} x \cos(2\pi n x) dx
            \\&
            =
            \frac{2}{T}
            \left[ x \frac{ \sin(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            -
            \frac{2}{T}
            \int_{0}^{1} \frac{ \sin(2\pi n x) }{ 2\pi n } dx
            \\&
            =
            \frac{2}{T}
            \left[ x \frac{ \sin(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{2}{T}
            \left[ \frac{ \cos(2\pi n x) }{ 4\pi^2 n^2 } \right]_{x=0}^{x=1}
            \\&
            =
            \frac{2}{T}
            \frac{1}{2\pi n}
            \left( \sin(2\pi n) - \sin(0) \right)
            +
            \frac{2}{T}
            \frac{1}{ 4\pi^2 n^2 }
            \left( \cos(2\pi n) - \cos(0) \right)
            \\&
            =
            0
        \end{align*}	
        Lastly, 
        \begin{align*}
            b_n^{\tilde g} 
            &
            = 
            \frac{2}{T}
            \int_{0}^{1} x \sin(2\pi n x) dx
            \\&
            =
            \frac{2}{T}
            \left[- x \frac{ \cos(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{2}{T}
            \int_{0}^{1} \frac{ \cos(2\pi n x) }{ 2\pi n } dx
            \\&
            =
           \frac{2}{T}
            \left[- x \frac{ \cos(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{2}{T}
            \left[ \frac{ \sin(2\pi n x) }{ 4\pi^2 n^2 } \right]_{x=0}^{x=1}
            \\&
            = 
            -\frac{2}{T}\frac{1}{2\pi n} =  -\frac{1}{\pi n} 
        \end{align*}	
        Now the Fourier coefficients of $g(x)$ are given by
                \begin{align*}
                    &b_n = -\frac{1}{\pi n} - - \frac{1}{\pi n} = 0
                    \\& 
            a_n = 0 - \frac{1}{2\pi^2 n^2} =  - \frac{1}{\pi^2 n^2} 
                    \\&
            a_0 = \frac{1}{2} - \frac{1}{3} = \frac{1}{6}
        \end{align*}	
        \item
        Note that $h(x)$ is an even function.
        Therefore $b_n = 0$. 
        We calculate the average 
        \[
            a_0 
            = 
            \frac{1}{T} \int_{0}^{1} |\sin 2\pi x| dx  
            = 
            \frac{2}{T} \int_{0}^{\frac 1 2} \sin 2\pi x dx  
            =  
            \frac 2 T
            \left[ \frac{-1}{2\pi} \cos{2\pi x} \right]_{0}^{\frac 1 2} 
            =
            \frac{2}{\pi} 
            .
        \]
        The coefficients $a_n$ for the cosine modes with $n \geq 1$ are:
        \begin{align*}
            a_n 
            &
            = 
            \frac{4}{T}
            \int_{0}^{\frac 1 2} \sin 2\pi x \cos(2\pi n x) dx
            \\&
            =
            \frac{4}{T}
            \int_{0}^{\frac 1 2} \frac 1 2 \sin{2\pi(1-n)x} + \frac 1 2 \sin{2\pi(n+1)x} dx
            \\&
		=
            \frac{4}{T}
            \int_{0}^{\frac 1 2} -\frac 1 2 \sin{2\pi(n-1)x} + \frac 1 2 \sin{2\pi(n+1)x} dx
            \\&
            =
            \left[\frac{ \cos2\pi(n-1)x }{ \pi(n-1) } \right]_{x=0}^{x=\frac 1 2}
            +
            \left[- \frac{ \cos2\pi(n+1)x }{ \pi(n+1) } \right]_{x=0}^{x=\frac 1 2}
            \\&
            = 
            \frac{(-1)^{n-1}}{\pi(n-1)} -  \frac{1}{\pi(n-1)}  - \frac{(-1)^{n+1}}{\pi(n+1)} + \frac{1}{\pi(n+1)}
            \\&
            = -\frac{1+(-1)^{n}}{\pi(n-1)} +  \frac{1-(-1)^{n+1}}{\pi(n+1)} 
            \\&
            = -\frac{1+(-1)^{n}}{\pi(n-1)} +  \frac{1+(-1)^{n}}{\pi(n+1)} 
        \end{align*}	
        Therefore, when $n \geq 1$:
        \[a_n = 
        \begin{cases}
        0 ,\quad &\text{if } n\text{ is odd,}\\
        -\frac{2}{\pi(n-1)} + \frac{2}{\pi(n+1)}  ,\quad &\text{if } n\text{ is even,}
        \end{cases}
        \]
       \end{itemize}
\end{solution}

\begin{exercise}
    Compute the Fourier coefficients of the following functions, which have period $T = 2\pi$ and have the given values over the interval $[0,2\pi)$:
    \begin{itemize}
     \item 
     \[
        f(x) = e^{x - \pi}
     \]
     \item 
     \[
        g(x) = {(x - \pi)^3}
     \]
     \item 
     \[
        h(x) = \left\{\begin{array}{ll}
            \sin(x) & 0 \leq x < \frac \pi 2
            \\
            0   & \frac \pi 2 \leq x < \frac{3\pi}{2} 
            \\
            \sin(x) & \frac {3\pi} 2 \leq x < 2\pi
        \end{array}\right.
     \]
     %
    \end{itemize}
\end{exercise}
\begin{solution}     
    \begin{itemize}
    \item To compute the Fourier coefficients of $f(x)$ with a period of $2\pi$, use the formulas from the lecture:
    \[
        a_0 
        = 
        \frac{1}{2\pi}\int_{0}^{2\pi} f(x) dx  = \frac{1}{2\pi}\int_{0}^{2\pi} e^{x-\pi} dx  = \frac{1}{2\pi}\left[ e^{x-\pi} \right]_{0}^{2\pi} = \frac{1}{\pi}\left(e^{\pi} - e^{-\pi}\right)
    \]
    For other coefficients, we apply integration by parts twice, and see that we obtain the same integral again:
    \begin{align*}
        a_n 
        &
        = 
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x - \pi} \cos( n x) dx
        \\&
        =
        \frac{1}{\pi}
        \left[ e^{x - \pi} \frac{ \sin(n x) }{ n } \right]_{x=0}^{x=2\pi}
        -
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ \sin( n x) }{ n } dx
        \\&
        =
        \frac{1}{\pi}
        \left[ e^{x - \pi} \frac{ \sin(n x) }{ n } \right]_{x=0}^{x=2\pi}
        -
        \frac{1}{\pi}
        \left[ e^{x - \pi} \frac{ -\cos(n x) }{ n^2 } \right]_{x=0}^{x=2\pi}
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ -\cos(n x) }{ n^2 } dx
        \\&
        =
        \frac{1}{\pi}
        \left( e^{\pi} \frac{ \sin(2\pi x) }{ n } - e^{0 - \pi} \frac{ \sin(n 0) }{ n } \right)
        -
        \frac{1}{\pi}
        \left( e^{\pi} \frac{ -\cos(n 2\pi) }{ n^2 } - e^{- \pi} \frac{ -\cos(n 0) }{ n^2 } \right)
        \\&\qquad\qquad
        +
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ -\cos(n x) }{ n^2 } dx
        \\&
        =
        \frac{1}{\pi}\frac{e^{\pi} - e^{-\pi}}{n^2}
        +
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ -\cos(n x) }{ n^2 } dx
        \\&
        =
        \frac{1}{\pi}\frac{e^{\pi} - e^{-\pi}}{n^2}
        -
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ \cos(n x) }{ n^2 } dx
        \end{align*}
        We rearrange that 
        \begin{align*}
            \int_{0}^{2\pi} e^{x-\pi} \cos(n x) dx
            &=
            \frac{e^{\pi} - e^{-\pi}}{ n^2}
            -
            \frac{1}{n^2}
            \int_{0}^{2\pi} e^{x-\pi} \cos(n x) dx
            \\
            \implies\qquad 
            \left( 1 + \frac 1 {n^2} \right)
            \int_{0}^{2\pi} e^{x-\pi} \cos(n x) dx
            &=
            \frac{e^{\pi} - e^{-\pi}}{ n^2}
            \\
            \implies\qquad 
            \int_{0}^{2\pi} e^{x-\pi} \cos(n x) dx
            &=
            \left( 1 + \frac 1 {n^2} \right)^{-1}
            \frac{e^{\pi} - e^{-\pi}}{ n^2}
            .   
        \end{align*}
        We conclude that 
        \begin{align*}
            a_n := 
            \frac{1}{\pi}
            \int_{0}^{2\pi} e^{x - \pi} \cos( n x) dx 
            &= 
            \left( 1 + \frac 1 {n^2} \right)^{-1}
            \frac{e^{\pi} - e^{-\pi}}{\pi n^2}
            \\&= 
            \left( \frac {n^2+ 1} {n^2} \right)^{-1}
            \frac{e^{\pi} - e^{-\pi}}{\pi n^2}
            \\&= 
            \frac{n^2}{1+n^2}
            \frac{e^{\pi} - e^{-\pi}}{\pi n^2}
            \\&= 
            \frac{e^{\pi} - e^{-\pi}}{(1+n^2)\pi}
        \end{align*}
        The coefficients of the sine modes are:
        \begin{align*}
            b_n 
            &
            = 
            \frac{1}{\pi}
            \int_{0}^{2\pi} e^{x - \pi} \sin(n x) dx
            \\&
            =
            \frac{1}{\pi}
            \left[- e^{x - \pi} \frac{ \cos( n x) }{ n } \right]_{x=0}^{x=2\pi}
            +
            \frac{1}{\pi}
            \int_{0}^{2\pi} \frac{ e^{x - \pi} \cos( n x) }{ n } dx
            \\&
            =
            \frac{1}{\pi}
             \left[- e^{x - \pi} \frac{ \cos( n x) }{ n } \right]_{x=0}^{x=2\pi}
            +
            \frac{1}{\pi}
            \left[ e^{x-\pi} \frac{ \sin(n x) }{ n^2 } \right]_{x=0}^{x=2\pi}
            -
            \frac{1}{\pi}
            \int_{0}^{2\pi} e^{x-\pi}\frac{ \sin(n x) }{n^2 } dx
            \\&
            =
            \frac{1}{\pi}\frac{e^{-\pi} - e^{\pi}}{n}
            -
            \frac{1}{\pi}
            \int_{0}^{2\pi} e^{x-\pi}\frac{ \sin(n x) }{n^2 } dx
        \end{align*}
        Similar as above, it follows that 
        \begin{align*}
            b_n:= \frac{1}{\pi}
                    \int_{0}^{2\pi} e^{x - \pi} \sin(n x) dx = \frac{1}{1 + \frac{1}{n^2}} \frac{1}{\pi}\frac{e^{-\pi} - e^{\pi}}{n} = \frac{1}{\pi}  \frac{e^{-\pi} - e^{\pi}}{n + \frac{1}{n}}
        \end{align*}
    %subquestion 2
    \item
% <<<<<<< HEAD
    We compute the average 
    \begin{align*}
        a_0
        :=
        \frac{1}{2\pi} \int_{0}^{2\pi} (x-\pi)^{3} dx
        =
        \frac{1}{2\pi} \int_{-\pi}^{\pi} z^{3} dz
        =
        0
        .
    \end{align*}
    We compute the coefficients of the cosine modes: for $n \geq 1$, we find 
    \begin{align*}
        a_n
        &:=
        \frac{2}{2\pi} \int_{0}^{2\pi} (x-\pi)^{3} \cos(nx) dx
        \\&=
        \frac{1}{\pi} \int_{0}^{2\pi} (x-\pi)^{3} \cos(nx) dx
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \cos(n(z+\pi)) dz
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \cos(nz+n\pi)) dz
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \cos(nz)) dz
        \cdot \left\{\begin{array}{ll} 1 & \text{ if $n$ is even } \\ -1 & \text{ if $n$ is odd } \end{array}\right.
        .
    \end{align*}
    However, $z^3 \cos(nz)$ is the product of an odd and an even function, and so the integral vanishes. 
    Explicitly:
    \begin{align*}
        \int_{-\pi}^{\pi} z^{3} \cos(nz)) dz
        &=
        \int_{-\pi}^{0} z^{3} \cos(nz)) dz
        + 
        \int_{0}^{\pi} z^{3} \cos(nz)) dz
        \\&=
        - 
        \int_{0}^{\pi} w^{3} \cos(nw)) dw
        + 
        \int_{0}^{\pi} z^{3} \cos(nz)) dz
        = 
        0.
    \end{align*}
    Finally, we compute the coefficients of the sine modes:
    \begin{align*}
        b_n
        &:=
        \frac{2}{2\pi} \int_{0}^{2\pi} (x-\pi)^{3} \sin(nx) dx
        \\&=
        \frac{1}{\pi} \int_{0}^{2\pi} (x-\pi)^{3} \sin(nx) dx
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \sin(n(z+\pi)) dx
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \sin(nz) dz
        \cdot \left\{\begin{array}{ll} 1 & \text{ if $n$ is even } \\ -1 & \text{ if $n$ is odd } \end{array}\right.
        .
    \end{align*}
    In either case, since $z^3$ and $\sin(nz)$ are odd functions,
    \begin{align*}
        \int_{-\pi}^{\pi} z^{3} \sin(nz) dz
        &=
        2\int_{0}^{\pi} z^{3} \sin(nz) dz
        .
    \end{align*}
    We perform integration by parts several times:
    \begin{align*}
        &
        \int_{0}^{\pi} z^{3} \sin(nz) dz
        \\&=
        -
        \frac 1 {n} 
        \left[ z^{3} \cos(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 3 {n}
        \int_{0}^{\pi} z^{2} \cos(nz) dz
        \\&=
        -
        \frac 1 {n} 
        \left[ z^{3} \cos(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 3 {n^2} 
        \left[ z^{2} \sin(nz) \right]_{z=0}^{z=\pi}
        -
        \frac 6 {n^2} 
        \int_{0}^{\pi} z \sin(nz) dz
        \\&=
        - \frac 1 {n} 
        \left[ z^{3} \cos(nz) \right]_{z=0}^{z=\pi}
        + 
        \frac 3 {n^2}
        \left[ z^{2} \sin(nz) \right]_{z=0}^{z=\pi}
        -
        \frac 6 {n^3} 
        \left[ z \cos(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 6 {n^3} 
        \int_{0}^{\pi} \cos(nz) dz
        \\&=
        - \frac 1 {n} 
        \left[ z^{3} \cos(nz) \right]_{z=0}^{z=\pi}
        + 
        \frac 3 {n^2}
        \left[ z^{2} \sin(nz) \right]_{z=0}^{z=\pi}
        -
        \frac 6 {n^3} 
        \left[ z \cos(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 6 {n^4} 
        \left[ \sin(nz) \right]_{z=0}^{z=\pi}
        \\&=
	-\frac{\pi^3(-1)^n}{n}-\frac{6\pi(-1)^n}{n^3} 
	\\&\implies
            b_n = 
            \begin{cases}
            \frac{2\pi^2}{n}+\frac{12}{n^3}  ,\quad &\text{if } n\text{ is odd,}\\
            -\frac{2\pi^2}{n}-\frac{12}{n^3}   ,\quad &\text{if } n\text{ is even,}
            \end{cases}
    \end{align*}
% 
% 
% =======
% To compute the Fourier coefficients of $g(x)$ over the interval $[0,2\pi)$ with a period of $2\pi$, we use the formulas from the lecture:
%         \[
%             a_0 = \frac{1}{2\pi}\int_{0}^{2\pi} f(x) dx  = \frac{1}{2\pi}\int_{0}^{2\pi} (x-\pi)^3 dx  = \left[ \frac{(x-\pi)^4}{4} \right]_{0}^{2\pi} = \frac{1}{2\pi}\frac 1 4 \pi^4 - \frac{1}{2\pi}\frac 1 4 (-\pi)^4 = 0.
%         \]
%         Note that the function is odd therefore $a_n = 0$. For $b_n$, we apply integration by parts thrice, and we use that $\sin$ vanishes at multiples of $\pi$:
%         \begin{align*}
%             b_n 
%             &
%             = 
%             \frac{2}{2\pi}
%             \int_{0}^{2\pi} (x-\pi)^3 \sin(n x) dx
%             \\&
%             =
%             \frac{2}{\pi}
%             \int_{0}^{\pi} (x-\pi)^3 \sin(n x) dx
%             \\&
%             =
%             \frac{2}{\pi}
%             \left[- (x-\pi)^3 \frac{ \cos(n x) }{n } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \int_{0}^{\pi} \frac{ 3(x-\pi)^2 \cos(n x) }{ n } dx
%             \\&
%             =
%  		\frac{2}{\pi}
%             \left[- (x-\pi)^3 \frac{ \cos(n x) }{n } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 3(x-\pi)^2 \frac{ \sin(n x) }{ n^2 } \right]_{x=0}^{x=\pi}
%             -
%             \frac{2}{\pi}
%             \int_{0}^{\pi} 6(x-\pi)\frac{ \sin( n x) }{n^2 } dx
%             \\&
%             =
%             \frac{2}{\pi}
%             \left[- (x-\pi)^3 \frac{ \cos(n x) }{n } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 3(x-\pi)^2 \frac{ \sin(n x) }{ n^2 } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 6(x-\pi)\frac{ \cos( n x) }{ n^3 } \right]_{x=0}^{x=\pi}
% 		-
%             \frac{2}{\pi}
%             \int_{0}^{\pi} 6\frac{ \cos( n x) }{ n^3 } dx
%             \\&
%             =
%  		\frac{2}{\pi}
%             \left[- (x-\pi)^3 \frac{ \cos(n x) }{n } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 3(x-\pi)^2 \frac{ \sin(n x) }{ n^2 } \right]_{x=0}^{x=\pi}
%             -
%             \frac{2}{\pi}
%             \int_{0}^{\pi} 6(x-\pi)\frac{ \sin( n x) }{n^2 } dx
%             \\&
%             =
%             \frac{2}{\pi}
%             \left[- (x-\pi)^3 \frac{ \cos(n x) }{n } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 3(x-\pi)^2 \frac{ \sin(n x) }{ n^2 } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 6(x-\pi)\frac{ \cos( n x) }{ n^3 } \right]_{x=0}^{x=\pi}
% 		-
%             \frac{2}{\pi}
%             \left[ 6\frac{ \sin( n x) }{ n^3 } \right]_{x=0}^{x=\pi}
% 		\\&
%             =\frac{2}{\pi}
%             \left[- (x-\pi)^3 \frac{ \cos(n x) }{n } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 6(x-\pi)\frac{ \cos( n x) }{ n^3 } \right]_{x=0}^{x=\pi}
% 		\\&
% 		= -\frac{2\pi^2}{n}+\frac{12}{n^3}
%         \end{align*}
% >>>>>>> 602337bdc4aee219b2f971dc33945611c0773aed
    %subquestion 3
    \item 
    The average of $h(x)$ over $1$ period $T$ is $0$ therefore:
    \[
        a_0 = 0
    \]
    Moreover $h(x)$ is odd therefore $a_n = 0$. For $b_n$ we have:
    \begin{align*}
        b_n 
        &
        = 
        \frac{2}{2\pi}
        \int_{0}^{\frac{\pi}{2}} \sin(x) \sin(n x) dx
        +
        \frac{2}{2\pi}
        \int_{\frac{3\pi}{2}}^{2\pi} \sin(x) \sin(n x) dx
        \\&
        =
        \frac{2}{2\pi}
        \int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} \sin(x) \sin(n x) dx
        \\&
        =
        \frac{1}{\pi}
        \int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} \sin(x) \sin(n x) dx
        \\&
        =
        \frac{2}{\pi}
        \int_{0}^{\frac{\pi}{2}} \sin(x) \sin(n x) dx
        \\&
        =
        \frac{1}{\pi}
        \int_{0}^{\frac{\pi}{2}} \cos((n-1)x) - \cos((n+1)x) dx
        \\&
        =
        \frac{1}{\pi}
        \left[ \frac{\sin((n-1)x)}{n-1} - \frac{\sin((n+1)x)}{n+1}\right]_{x=0}^{x=\frac{\pi}{2}}
        \\&
        =
        \frac{\sin((n-1)\frac{\pi}{2})}{n-1} - \frac{\sin((n+1)\frac{\pi}{2})}{n+1}
    \end{align*}
    If $n$ is odd, then $n-1$ and $n+1$ are both even, and so $(n-1)\frac{\pi}{2}$ and $(n+1)\frac{\pi}{2}$ will be integer multiples of $\pi$. 
    Hence $a_n$ is zero if $n$ is odd. 
    For the even numbers, we have got another case distinction:
    if $n=1,5,9,\dots$, then 
    \begin{align*}
        b_n = \frac{1}{n-1} - \frac{-1}{n+1} = \frac{1}{n-1} + \frac{1}{n+1} = \frac{n+1+n-1}{n^2+1} = \frac{2n}{n^2+1}.
    \end{align*}
    if $n=3,7,11,\dots$, then 
    \begin{align*}
        b_n = \frac{-1}{n-1} - \frac{1}{n+1} = \frac{-n-1-n+1}{n^2+1} = \frac{-2n}{n^2+1}.
    \end{align*}
    

    
\end{itemize}
\end{solution}


\begin{exercise}
    Compute the Fourier coefficients of the function $f$ with period $T = 2\pi$ and which satisfies 
     \[
        f(x) = \sin(x) \text{ if } 0 \leq x  < \pi,
     \]
     and 
     \[
        f(x) = f(-x) \text{ for all } x \in \mathbb R.
     \]
\end{exercise}
\begin{solution}     
    Note that $f(x)$ is an even function,
    therefore $b_n = 0$. 
    The average is 
	\[
        a_0 = \frac{2}{2\pi} \int_{0}^{\pi} \sin x dx  =  \frac{1}{\pi}\left[ - \cos{x} \right]_{0}^{\pi} =\frac{2}{\pi} .
    \]
    The cosine mode coefficients are:
    \begin{align*}
            a_n 
            &
            = 
            \frac{2}{T}
            \int_{-\pi}^{\pi} \sin x \cos(n x) dx
            \\&
            = 
            \frac{4}{T}
            \int_{0}^{\pi} \sin x \cos(n x) dx
            \\&
            =
            \frac{4}{T}
            \int_{0}^{\pi} \frac 1 2 \sin((1-n)x) + \frac 1 2 \sin((n+1)x) dx
            \\&
		=
            \frac{4}{T}
            \int_{0}^{\pi} -\frac 1 2 \sin((n-1)x) + \frac 1 2 \sin((n+1)x) dx
            \\&
            =
           \frac{4}{T}
            \left[\frac{ \cos((n-1)x) }{ 2(n-1) } \right]_{x=0}^{x=\pi}
            +
            \frac{4}{T}
            \left[- \frac{ \cos((n+1)x) }{ 2(n+1) } \right]_{x=0}^{x=\pi}
            \\&
            = 
            -\frac 4 T \frac{(-1)^{n-1}}{2(n-1)} - \frac 4 T \frac{1}{2(n-1)}  -\frac 4 T \frac{(-1)^{n+1}}{2(n+1)} + \frac 4 T \frac{1}{2(n+1)}
            \\&
            = -\frac{1+(-1)^{n}}{\pi(n-1)} +  \frac{1-(-1)^{n+1}}{\pi(n+1)} 
        \end{align*}	
        \[
            a_n = 
            \begin{cases}
            0 ,\quad &\text{if } n\text{ is odd,}\\
            -\frac{2}{\pi(n-1)} + \frac{2}{\pi(n+1)}  ,\quad &\text{if } n\text{ is even,}
            \end{cases}
        \]
\end{solution}


\end{document}
