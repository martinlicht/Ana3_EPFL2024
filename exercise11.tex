\documentclass[11pt]{article}
% % \def\hidesolutions{}
\input{header}
\begin{document}
\exsheet{11}{28}{November} % parameters are the number of the session and the day




\begin{exercise}
    Compute the Fourier coefficients of the following functions, which have period $T = 2\pi$ and have the given values over the interval $[0,2\pi)$:
    \begin{itemize}
     \item 
     \[
        f(x) = e^{x - \pi}
     \]
     \item 
     \[
        g(x) = {(x - \pi)^3}
     \]
     \item 
     \[
        h(x) = \left\{\begin{array}{ll}
            \sin(x) & 0 \leq x < \frac \pi 2
            \\
            0   & \frac \pi 2 \leq x < \frac{3\pi}{2} 
            \\
            \sin(x) & \frac {3\pi} 2 \leq x < 2\pi
        \end{array}\right.
     \]
     %
    \end{itemize}
    Hint: Recall that $\cos(\frac \pi 2 - \theta) = \sin \theta$ and $\cos(\frac{3 \pi}{2} - \theta) = - \sin \theta$.
\end{exercise}
\begin{solution}     
    \begin{itemize}
    \item To compute the Fourier coefficients of $f(x)$ with a period of $2\pi$, use the formulas from the lecture:
    \[
        \frac{ a_0 }{2}
        = 
        \frac{1}{2\pi}\int_{0}^{2\pi} f(x) dx  = \frac{1}{2\pi}\int_{0}^{2\pi} e^{x-\pi} dx  = \frac{1}{2\pi}\left[ e^{x-\pi} \right]_{0}^{2\pi} = \frac{1}{2\pi}\left(e^{\pi} - e^{-\pi}\right)
    \]
    For other coefficients, we apply integration by parts twice, and see that we obtain the same integral again:
    \begin{align*}
        a_n 
        &
        = 
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x - \pi} \cos( n x) dx
        \\&
        =
        \frac{1}{\pi}
        \left[ e^{x - \pi} \frac{ \sin(n x) }{ n } \right]_{x=0}^{x=2\pi}
        -
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ \sin( n x) }{ n } dx
        \\&
        =
        \frac{1}{\pi}
        \left[ e^{x - \pi} \frac{ \sin(n x) }{ n } \right]_{x=0}^{x=2\pi}
        -
        \frac{1}{\pi}
        \left[ e^{x - \pi} \frac{ -\cos(n x) }{ n^2 } \right]_{x=0}^{x=2\pi}
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ -\cos(n x) }{ n^2 } dx
        \\&
        =
        \frac{1}{\pi}
        \left( e^{\pi} \frac{ \sin(2\pi x) }{ n } - e^{0 - \pi} \frac{ \sin(n 0) }{ n } \right)
        -
        \frac{1}{\pi}
        \left( e^{\pi} \frac{ -\cos(n 2\pi) }{ n^2 } - e^{- \pi} \frac{ -\cos(n 0) }{ n^2 } \right)
        \\&\qquad\qquad
        +
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ -\cos(n x) }{ n^2 } dx
        \\&
        =
        \frac{1}{\pi}\frac{e^{\pi} - e^{-\pi}}{n^2}
        +
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ -\cos(n x) }{ n^2 } dx
        \\&
        =
        \frac{1}{\pi}\frac{e^{\pi} - e^{-\pi}}{n^2}
        -
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ \cos(n x) }{ n^2 } dx
        \end{align*}
        We rearrange that 
        \begin{align*}
            \int_{0}^{2\pi} e^{x-\pi} \cos(n x) dx
            &=
            \frac{e^{\pi} - e^{-\pi}}{ n^2}
            -
            \frac{1}{n^2}
            \int_{0}^{2\pi} e^{x-\pi} \cos(n x) dx
            \\
            \implies\qquad 
            \left( 1 + \frac 1 {n^2} \right)
            \int_{0}^{2\pi} e^{x-\pi} \cos(n x) dx
            &=
            \frac{e^{\pi} - e^{-\pi}}{ n^2}
            \\
            \implies\qquad 
            \int_{0}^{2\pi} e^{x-\pi} \cos(n x) dx
            &=
            \left( 1 + \frac 1 {n^2} \right)^{-1}
            \frac{e^{\pi} - e^{-\pi}}{ n^2}
            .   
        \end{align*}
        We conclude that 
        \begin{align*}
            a_n := 
            \frac{1}{\pi}
            \int_{0}^{2\pi} e^{x - \pi} \cos( n x) dx 
            &= 
            \left( 1 + \frac 1 {n^2} \right)^{-1}
            \frac{e^{\pi} - e^{-\pi}}{\pi n^2}
            \\&= 
            \left( \frac {n^2+ 1} {n^2} \right)^{-1}
            \frac{e^{\pi} - e^{-\pi}}{\pi n^2}
            \\&= 
            \frac{n^2}{1+n^2}
            \frac{e^{\pi} - e^{-\pi}}{\pi n^2}
            \\&= 
            \frac{e^{\pi} - e^{-\pi}}{(1+n^2)\pi}
        \end{align*}
        The coefficients of the sine modes are:
        \begin{align*}
            b_n 
            &
            = 
            \frac{1}{\pi}
            \int_{0}^{2\pi} e^{x - \pi} \sin(n x) dx
            \\&
            =
            \frac{1}{\pi}
            \left[- e^{x - \pi} \frac{ \cos( n x) }{ n } \right]_{x=0}^{x=2\pi}
            +
            \frac{1}{\pi}
            \int_{0}^{2\pi} \frac{ e^{x - \pi} \cos( n x) }{ n } dx
            \\&
            =
            \frac{1}{\pi}
             \left[- e^{x - \pi} \frac{ \cos( n x) }{ n } \right]_{x=0}^{x=2\pi}
            +
            \frac{1}{\pi}
            \left[ e^{x-\pi} \frac{ \sin(n x) }{ n^2 } \right]_{x=0}^{x=2\pi}
            -
            \frac{1}{\pi}
            \int_{0}^{2\pi} e^{x-\pi}\frac{ \sin(n x) }{n^2 } dx
            \\&
            =
            \frac{1}{\pi}\frac{e^{-\pi} - e^{\pi}}{n}
            -
            \frac{1}{\pi}
            \int_{0}^{2\pi} e^{x-\pi}\frac{ \sin(n x) }{n^2 } dx
        \end{align*}
        Similar as above, it follows that 
        \begin{align*}
            b_n:= \frac{1}{\pi}
                    \int_{0}^{2\pi} e^{x - \pi} \sin(n x) dx = \frac{1}{1 + \frac{1}{n^2}} \frac{1}{\pi}\frac{e^{-\pi} - e^{\pi}}{n} = \frac{1}{\pi}  \frac{e^{-\pi} - e^{\pi}}{n + \frac{1}{n}}
        \end{align*}
    %subquestion 2
    \item
    We compute the average 
    \begin{align*}
        \frac{a_0}{2}
        :=
        \frac{1}{2\pi} \int_{0}^{2\pi} (x-\pi)^{3} dx
        =
        \frac{1}{2\pi} \int_{-\pi}^{\pi} z^{3} dz
        =
        0
        .
    \end{align*}
    We compute the coefficients of the cosine modes: for $n \geq 1$, we find 
    \begin{align*}
        a_n
        &:=
        \frac{2}{2\pi} \int_{0}^{2\pi} (x-\pi)^{3} \cos(nx) dx
        \\&=
        \frac{1}{\pi} \int_{0}^{2\pi} (x-\pi)^{3} \cos(nx) dx
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \cos(n(z+\pi)) dz
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \cos(nz+n\pi)) dz
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \cos(nz)) dz
        \cdot \left\{\begin{array}{ll} 1 & \text{ if $n$ is even } \\ -1 & \text{ if $n$ is odd } \end{array}\right.
        .
    \end{align*}
    However, $z^3 \cos(nz)$ is the product of an odd and an even function, and so the integral vanishes. 
    Explicitly:
    \begin{align*}
        \int_{-\pi}^{\pi} z^{3} \cos(nz)) dz
        &=
        \int_{-\pi}^{0} z^{3} \cos(nz)) dz
        + 
        \int_{0}^{\pi} z^{3} \cos(nz)) dz
        \\&=
        - 
        \int_{0}^{\pi} w^{3} \cos(nw)) dw
        + 
        \int_{0}^{\pi} z^{3} \cos(nz)) dz
        = 
        0.
    \end{align*}
    Finally, we compute the coefficients of the sine modes:
    \begin{align*}
        b_n
        &:=
        \frac{2}{2\pi} \int_{0}^{2\pi} (x-\pi)^{3} \sin(nx) dx
        \\&=
        \frac{1}{\pi} \int_{0}^{2\pi} (x-\pi)^{3} \sin(nx) dx
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \sin(n(z+\pi)) dx
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \sin(nz) dz
        \cdot \left\{\begin{array}{ll} 1 & \text{ if $n$ is even } \\ -1 & \text{ if $n$ is odd } \end{array}\right.
        .
    \end{align*}
    In either case, since $z^3$ and $\sin(nz)$ are odd functions,
    \begin{align*}
        \int_{-\pi}^{\pi} z^{3} \sin(nz) dz
        &=
        2\int_{0}^{\pi} z^{3} \sin(nz) dz
        .
    \end{align*}
    We perform integration by parts several times:
    \begin{align*}
        &
        \int_{0}^{\pi} z^{3} \sin(nz) dz
        \\&=
        -
        \frac 1 {n} 
        \left[ z^{3} \cos(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 3 {n}
        \int_{0}^{\pi} z^{2} \cos(nz) dz
        \\&=
        -
        \frac 1 {n} 
        \left[ z^{3} \cos(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 3 {n^2} 
        \left[ z^{2} \sin(nz) \right]_{z=0}^{z=\pi}
        -
        \frac 6 {n^2} 
        \int_{0}^{\pi} z \sin(nz) dz
        \\&=
        - \frac 1 {n} 
        \left[ z^{3} \cos(nz) \right]_{z=0}^{z=\pi}
        + 
        \frac 3 {n^2}
        \left[ z^{2} \sin(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 6 {n^3} 
        \left[ z \cos(nz) \right]_{z=0}^{z=\pi}
        -
        \frac 6 {n^3} 
        \int_{0}^{\pi} \cos(nz) dz
        \\&=
        - \frac 1 {n} 
        \left[ z^{3} \cos(nz) \right]_{z=0}^{z=\pi}
        + 
        \frac 3 {n^2}
        \left[ z^{2} \sin(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 6 {n^3} 
        \left[ z \cos(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 6 {n^4} 
        \left[ \sin(nz) \right]_{z=0}^{z=\pi}
        \\&=
	-\frac{\pi^3(-1)^n}{n}+\frac{6\pi(-1)^n}{n^3} 
	\\&\implies
            b_n = 
            \left(
                \begin{cases}
                \frac{2\pi^2}{n}-\frac{12}{n^3}  ,\quad &\text{if } n\text{ is odd,}\\
                -\frac{2\pi^2}{n}+\frac{12}{n^3}   ,\quad &\text{if } n\text{ is even,}
                \end{cases}
            \right)
            \cdot 
            \left(
                \begin{cases}
                    -1 & \text{ if $n$ is odd } 
                    \\ 
                    1 & \text{ if $n$ is even } 
                \end{cases}
            \right)
            =  
            -\frac{2\pi^2}{n}+\frac{12}{n^3}
            .
    \end{align*}
    \item 
    The average of $h(x)$ over $1$ period $T$ is $0$ therefore:
    \[
        \frac{a_0}{2} = 0
    \]
    Moreover $h(x)$ is odd therefore $a_n = 0$. Explicitly, we compute
    \begin{align*}
        a_n = \frac 1 \pi \int_0^{2 \pi} h(x) \cos(n x) dx = \frac 1 \pi \int_0^{\frac \pi 2} \sin(x) \cos(n x) dx + \frac 1 \pi \int_{\frac {3 \pi} 2}^{2 \pi} \sin(x) \cos(n x) dx.
    \end{align*}
    To compute the integrals, we apply the product-to-sum identity
    \begin{align*}
        \sin(x) \cos(n x) = \frac 1 2 \left( \sin((1 + n)x) + \sin((1 - n)x) \right).
    \end{align*}
    We obtain for the first integral
    \begin{align*}
        &\frac 1 \pi \int_0^{\frac \pi 2} \sin(x) \cos(n x) dx = \frac 1 \pi \int_0^{\frac \pi 2} \frac 1 2 \left( \sin((1 + n)x) + \sin((1 - n)x) \right) dx\\
        &= \frac 1 \pi \left( \frac 1 2 \left[ -\frac 1 {1 + n} \cos((1 + n)x) - \frac 1 {1 - n} \cos((1 - n)x) \right]_0^{\frac \pi 2} \right)\\
        &= -\frac{1}{n+1}\cos\left( \frac{(n+1) \pi}{2}\right) - \frac{1}{1 - n} \cos \left(\frac{(1 - n) \pi}{2} \right) + \frac{1}{n + 1} + \frac{1}{1 - n}\\
        &= \frac{1}{2 \pi (n^2 - 1)} \left[(1-n)\cos\left( \frac{\pi}{2} + \frac{n \pi}{2}\right) + (n + 1) \cos\left(\frac{\pi}{2} - \frac{n\pi}{2} \right)\right] - \frac{1}{\pi(n^2 - 1)}\\
        &= \frac{n \sin\left( \frac{n \pi}{2}\right) - 1}{\pi(n^2 - 1)},
    \end{align*}
    where we have applied the hint in the last equation. For the second integral, we obtain
    \begin{align*}
        &\frac 1 \pi \int_{\frac {3 \pi} 2}^{2 \pi} \sin(x) \cos(n x) dx = \frac 1 \pi \int_{\frac {3 \pi} 2}^{2 \pi} \frac 1 2 \left( \sin((1 + n)x) + \sin((1 - n)x) \right) dx\\
        &= \frac 1 \pi \left( \frac 1 2 \left[ -\frac 1 {1 + n} \cos((1 + n)x) - \frac 1 {1 - n} \cos((1 - n)x) \right]_{\frac {3 \pi} 2}^{2 \pi} \right)\\
        &= \frac{1}{\pi(n^2 - 1)} + \frac{1}{2 \pi (1 - n^2)} \left[ (1 - n) \cos\left((1 + n)\frac{3 \pi}{2}\right) + (1 + n) \cos\left((1 - n) \frac{3 \pi}{2}\right)\right]\\
        &= \frac{1}{\pi(n^2 - 1)} + \frac{1}{2 \pi (1 - n^2)} \left[(1-n) \sin\left(\frac{3 \pi n}{2}\right) - (1 + n) \sin\left(\frac{3 \pi n}{2}\right)\right]\\
        &= \frac{1 + n \sin\left( \frac{3 \pi n}{2}\right)}{\pi(n^2 - 1)},
    \end{align*}
    again by using the hint. Therefore, we have
    \begin{align*}
        a_n = \frac{n}{\pi (n^2 - 1)} \left[ \sin\left( \frac{\pi n}{2}\right)  + \sin\left( \frac{3 \pi n}{2}\right)\right] = 0,
    \end{align*}
    since the sum-to-product formula for the sine yields
    \begin{align*}
        \sin\left( \frac{\pi n}{2}\right)  + \sin\left( \frac{3 \pi n}{2}\right) = 2 \sin\left(2 \pi n \right) \cos\left (\pi n \right) = 0.
    \end{align*}
    For $b_n$ we have:
    \begin{align*}
        b_n 
        &
        = 
        \frac{2}{2\pi}
        \int_{0}^{\frac{\pi}{2}} \sin(x) \sin(n x) dx
        +
        \frac{2}{2\pi}
        \int_{\frac{3\pi}{2}}^{2\pi} \sin(x) \sin(n x) dx
        \\&
        =
        \frac{2}{2\pi}
        \int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} \sin(x) \sin(n x) dx
        \\&
        =
        \frac{1}{\pi}
        \int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} \sin(x) \sin(n x) dx
        \\&
        =
        \frac{2}{\pi}
        \int_{0}^{\frac{\pi}{2}} \sin(x) \sin(n x) dx
        \\&
        =
        \frac{1}{\pi}
        \int_{0}^{\frac{\pi}{2}} \cos((n-1)x) - \cos((n+1)x) dx
        \\&
        =
        \frac{1}{\pi}
        \left[ \frac{\sin((n-1)x)}{n-1} - \frac{\sin((n+1)x)}{n+1}\right]_{x=0}^{x=\frac{\pi}{2}}
        \\&
        =
        \frac{n \left ( \cos(\frac{n \pi}{2}) + \cos(\frac{3 n \pi}{2})\right)}{\pi(1 - n^2)}
        \\&
        = \frac{2 n \cos(n \pi) \cos(- \frac{n \pi}{2})}{\pi ( 1 - n^2)} = \frac{2 n (-1)^n \cos(\frac{n \pi}{2})}{\pi ( 1 - n^2)},
    \end{align*}
    where we have again used a reflection formula an product-to-sum formula to simplify the trigonometric expressions. 
    Now we see immediately, that if $n$ is odd, then $b_n = 0$ since $\cos(\frac{n \pi}{2}) = 0$.
    Whenever $n$ is even, i.e. $n= 2k$ for some $k \in \mathbb N$, we have
    \begin{align*}
        b_n = b_{2k} = \frac{4 k (-1)^k}{\pi (1 - 4 k^2)}
    \end{align*}
\end{itemize}
\end{solution}


\begin{exercise}
     Compute the Fourier coefficients of the function $f$ with period $T = 2\pi$ and which satisfies 
     \[
        f(x) = \sin(x) \text{ if } 0 \leq x  < \pi,
     \]
     and 
     \[
        f(x) = f(-x) \text{ for all } x \in \mathbb R.
     \]
\end{exercise}
\begin{solution}     
    Note that $f(x)$ is an even function.
    Using a change of variables, we compute 
    \begin{align*}
        b_n
        &=
        \frac{2}{T}
        \int_{-\pi}^{\pi} f(x) \sin(n x) dx
        \\&
        = 
        \frac{2}{T}
        \int_{-\pi}^{0} f(x) \sin(n x) dx
        +
        \frac{2}{T}
        \int_{0}^{\pi} f(x) \sin(n x) dx
        \\&
        = 
        (-1)
        \frac{2}{T}
        \int_{\pi}^{0} f(-x) \sin( -n x) dx
        +
        \frac{2}{T}
        \int_{0}^{\pi} f(x) \sin(n x) dx
        \\&
        = 
        \frac{2}{T}
        \int_{0}^{\pi} f(x) \sin( -n x) dx
        +
        \frac{2}{T}
        \int_{0}^{\pi} f(x) \sin(n x) dx
        \\&
        = 
        -
        \frac{2}{T}
        \int_{0}^{\pi} f(x) \sin(n x) dx
        +
        \frac{2}{T}
        \int_{0}^{\pi} f(x) \sin(n x) dx
        =
        0
        .
    \end{align*}
    Therefore $b_n = 0$. 
    The average is 
	\[
        \frac{a_0}{2} = \frac{2}{2\pi} \int_{0}^{\pi} \sin x dx  =  \frac{1}{\pi}\left[ - \cos{x} \right]_{0}^{\pi} =\frac{2}{\pi} .
    \]
    The cosine mode coefficients are:
    \begin{align*}
            a_n 
            &
            = 
            \frac{2}{T}
            \int_{-\pi}^{\pi} f(x)   \cos(n x) dx
            \\&
            = 
            \frac{4}{T}
            \int_{0}^{\pi} \sin x \cos(n x) dx
            \\&
            =
            \frac{4}{T}
            \int_{0}^{\pi} \frac 1 2 \sin((1-n)x) + \frac 1 2 \sin((n+1)x) dx
            \\&
            =
            \frac{2}{T}
            \int_{0}^{\pi} \sin((1-n)x) + \sin((n+1)x) dx
            \\&
            =
            \frac{2}{T}
            \int_{0}^{\pi} -\sin((n-1)x) + \sin((n+1)x) dx
            \\&
            =
            \frac{2}{T}
            \left[\frac{ \cos((n-1)x) }{ (n-1) } \right]_{x=0}^{x=\pi}
            +
            \frac{2}{T}
            \left[- \frac{ \cos((n+1)x) }{ (n+1) } \right]_{x=0}^{x=\pi}
            \\&
            = 
            \frac 2 T 
            \left( 
                \frac{ \cos((n-1)\pi) }{(n-1)} 
                - 
                \frac{1}{(n-1)}
                -
                \frac{ \cos((n+1)\pi) }{(n+1)} 
                + 
                \frac{1}{(n+1)}
            \right)
            \\&
            = 
            \frac 2 T 
            \left( 
                \frac{ \cos( n \pi - \pi ) }{(n-1)} 
                - 
                \frac{1}{(n-1)}
                -
                \frac{ \cos( n \pi + \pi ) }{(n+1)} 
                + 
                \frac{1}{(n+1)}
            \right)
            \\&
            = 
            \frac 2 T 
            \left( 
                -
                \frac{ \cos(n\pi) }{(n-1)} 
                - 
                \frac{1}{(n-1)}
                +
                \frac{ \cos(n\pi) }{(n+1)} 
                + 
                \frac{1}{(n+1)}
            \right)
            \\&
            = 
            \frac 2 T 
            \left( 
                -
                \frac{ (-1)^n }{(n-1)} 
                - 
                \frac{1}{(n-1)}
                +
                \frac{ (-1)^n }{(n+1)} 
                + 
                \frac{1}{(n+1)}
            \right)
            \\&
            = 
            \frac 2 T 
            \left( 
                \frac{ 1 + (-1)^n }{(n+1)} 
                -
                \frac{ 1 + (-1)^n }{(n-1)} 
            \right)
            \\&
            = 
            \frac 1 \pi 
            \left( 
                \frac{ 1 + (-1)^n }{(n+1)} 
                -
                \frac{ 1 + (-1)^n }{(n-1)} 
            \right)
            .
        \end{align*}	
        Here, if $n$ is odd, the coefficient numerators are $1 + (-1) = 0$, and if $n$ is even, they are both equal $2$. Thus:
        \[
            a_n = 
            \begin{cases}
            0 ,\quad &\text{if } n\text{ is odd,}\\
            -\frac{2}{\pi(n-1)} + \frac{2}{\pi(n+1)}  ,\quad &\text{if } n\text{ is even,}
            \end{cases}
        \]
\end{solution}








\begin{exercise}
    Use Dirichlet's theorem to explain whether the Fourier series converges at $x \in [0,T]$ and to which value:
    \begin{itemize}
     \item \begin{gather*}
            f(x) = \left\{\begin{array}{ll}
                            x   & \text{ if $0 \leq x < 1$ }
                            \\
                            2 - x & \text{ if $1 \leq x < 2$ }
                          \end{array}\right., \qquad T = 2.
           \end{gather*}
     \item \begin{gather*}
            f(x) = \left\{\begin{array}{ll}
                            \pi   & \text{ if $0 \leq x < 1$ }
                            \\
                            e^{x-1} & \text{ if $1 \leq x < 2$ }
                            \\
                            \sin(x) & \text{ if $2 \leq x < 3$ }
                          \end{array}\right., \qquad T = 3.
           \end{gather*}
    \end{itemize}
    Here, the functions have the given period $T$.
\end{exercise}
\begin{solution}     
\begin{itemize}
\item $f$ is continuous and finite on the closed interval $[0,2]$ therefore the Fourier series, $F_N f$, converges to $f$ when we take the limit of $N$ going to $\infty$.
\item $f$ is continuous and finite on the closed intervals $[0,1]$, $[1,2]$ and $[2,3]$. 
However, note that $f$ is not continuous in $0$, $1$ and $2$.
Therefore the Fourier series, $F f$, converges to: 

\begin{gather*}
            g(x) = \left\{\begin{array}{ll}
                            \frac{\sin(3) + \pi}{2} & \text{ if $x = 0$ }
						\\
                            \pi   & \text{ if $0 < x < 1$ }
                            \\
                            \frac{\pi + 1}{2} & \text{ if $x = 1$ }
						\\
                            e^{x-1} & \text{ if $1 < x < 2$ }
						\\
                            \frac{\sin(2) + e^1}{2} & \text{ if $x = 2$ }
						\\
                            \sin(x) & \text{ if $2 < x < 3$ }
						\\
                            \frac{\sin(3) + \pi}{2} & \text{ if $x = 3$ }
                          \end{array}\right.
\end{gather*}
and we extend that function $g$ to a periodic function with period $T = 3$. 
\end{itemize}
\end{solution}

\begin{exercise}
    Give the Fourier series in complex notation, when $f$ has period $T = 2$ and 
    \begin{gather*}
        f(x) = x \text{ for } 0 \leq x < 2.
    \end{gather*}
\end{exercise}
\begin{solution}     
We can re-use the results about the sawtooth wave.
\begin{gather*}
    g(x)=x \text { for } 0 \leq x<1
    \\
    a_0^g = 1,\quad a_n^g = 0, \quad b_n^g = \frac{-1}{\pi n}
\end{gather*}
Moreover we can write $f$ in terms of $g$ by introducing $x = \frac{y}{2}$
\[
    f(y) = 2g(y/2)
\]
which gives us the Fourier coefficients of $f$
\begin{gather*}
    a_0^f = 2,\quad a_n^f = 0, \quad b_n^f = \frac{-2}{\pi n}
\end{gather*}
Using this we can obtain the Fourier coefficients $c_n$:
\[
    c_0 = \frac{ a_0 }{2} = 2,\quad c_n=\frac{a_n}{2}-\frac{b_n}{2} i = \frac{1}{n\pi}i, \quad c_{-n}=\frac{a_n}{2}+\frac{b_n}{2} i = -\frac{1}{n\pi}i
\]
such that 
\[
    F f(x)=\sum_{n=-\infty}^{\infty} c_n e^{\pi n x i}
\]
\end{solution}

\begin{exercise}
    Find the Fourier coefficients of $\cos(x)^8$ with period $T = 2\pi$.
    Use Parseval's identity to compute $\int_0^{2\pi} \cos(x)^{16} dx$.
\end{exercise}
\begin{solution}     
We will not use the standard approach in integrating the function $f$. Instead we try to rewrite $f$ as sum of $\cos(nx)$ using trigonometric formulas:
\begin{align*}
    \cos^2\alpha &= \frac 1 2 + \frac 1 2 \cos 2 \alpha
    \\
    \cos\alpha\cos\beta &= \frac 1 2 \cos (\alpha-\beta)+ \frac 1 2 \cos (\alpha + \beta) \\
\end{align*}
Using these formulas we can rewrite $f$ as follows:
\begin{align*}
    \cos^8x &= (\cos^2x)^4\\
    &= (\frac 1 2 + \frac 1 2 \cos 2x)^4\\
    &= ((\frac 1 2 + \frac 1 2 \cos 2x)^2)^2\\
    &= (\frac 1 4 + \frac 1 2 \cos 2x + \frac 1 4 \cos ^2 2 x)^2\\
    &= (\frac 1 4 + \frac 1 2 \cos 2x + \frac 1 4 \cos ^2 2 x)^2\\
    &= (\frac 1 4 + \frac 1 2 \cos 2x + \frac 1 4 \cos ^2 2x)(\frac 1 4 + \frac 1 2 \cos 2x + \frac 1 4 \cos ^2 2x)\\
    &= \frac{1}{16}+\frac 1 4 \cos 2x + \frac 3 8 \cos^2 2x + \frac 1 4 \cos^3 2x +\frac{1}{16} \cos^4 2x\\
    &= \frac{1}{16}+\frac 1 4 \cos 2x + \frac 3 8 (\frac 1 2 + \frac 1 2 \cos 4x) + \frac 1 4 \cos^3 2x +\frac{1}{16} \cos^4 2x\\
    &= \frac{4}{16}+\frac 1 4 \cos 2x + \frac{3}{16} \cos 4x + \frac 1 4 \cos^3 2x +\frac{1}{16} \cos^4 2x\\
\end{align*}
Now we consider $\cos^3 2x$ and $\cos^4 2x$ seperately:
\begin{align*}
    \cos^3 2x &= \cos 2x \cos^2 2x\\
    &= (\frac 1 2 + \frac 1 2 \cos 4x) \cos 2x\\
    &= \frac 1 2 \cos 2x + \frac 1 2 \cos 4 x \cos 2 x \\
    &= \frac 1 2 \cos 2x + \frac 1 4 \cos 6 x  + \frac 1 4 \cos 2 x \\
    &= \frac 3 4 \cos 2x + \frac 1 4 \cos 6 x \\
\end{align*}
\begin{align*}
    \cos^4 2x &= (\cos^2 2x)^2\\
    &=(\frac 1 2 + \frac 1 2 \cos 4x)^2\\
    &= \frac 1 4 + \frac 1 2 \cos 4x + \frac 1 4 \cos^2 4x\\
    &= \frac 1 4 + \frac 1 2 \cos 4x + \frac 1 4 (\frac 1 2 + \frac 1 2 \cos 8x)\\
    &= \frac 3 8 + \frac 1 2 \cos 4x + \frac 1 8 \cos 8x\\
\end{align*}
putting everything together we have:
\[
    \cos^8x  = \frac{35}{128} + \frac{7}{16}\cos 2x + \frac{7}{32}\cos 4x + \frac{1}{16} \cos 6x + \frac{1}{128}\cos 8x
\]
For the second part we use Parseval's identity which is given by: 
\[
    \frac{2}{T} \int_0^T f(x)^2 d x= \frac{a_0^2}{2}+\sum_{n=0}^{\infty}\left(a_n\right)^2+\left(b_n\right)^2
\]
substituting our Fourier coefficients and $f$ gives: 
\begin{align*}
    \frac{2}{T} \int_0^T f(x)^2 d x&= \frac{a_0^2}{2}+\sum_{n=0}^{\infty}\left(a_n\right)^2+\left(b_n\right)^2\\
    \frac{1}{\pi} \int_0^{2\pi} \cos(x)^{16} d x&= 2\left(\frac{35}{128}\right)^2 + \left(\frac{7}{16}\right)^2 + \left(\frac{7}{32}\right)^2 + \left(\frac{1}{16}\right)^2 + \left(\frac{1}{128}\right)^2.\\
    \implies 
    \int_0^{2\pi} \cos(x)^{16} d x
    &= 
    \pi\left(2\left(\frac{35}{128}\right)^2 + \left(\frac{7}{16}\right)^2 + \left(\frac{7}{32}\right)^2 + \left(\frac{1}{16}\right)^2 + \left(\frac{1}{128}\right)^2\right)
\end{align*}
We simplify this value:
\begin{align*}
    &
    2 \left(\frac{35}{128}\right)^2 
    + 
    \left(\frac{7}{16}\right)^2 
    + 
    \left(\frac{7}{32}\right)^2 
    + 
    \left(\frac{1}{16}\right)^2 
    + 
    \left(\frac{1}{128}\right)^2
    =
    6435
\end{align*}
Therefore, in total,
\begin{align*}
    \int_0^{2\pi} \cos(x)^{16} d x
    =
    \pi 
    \frac{ 6435 }{ 16384 }
    \approx 
    1.233895796
\end{align*}
\end{solution}

\begin{exercise}
    Give the Fourier series of the function $f$ with period $T = 2$ and 
    \begin{gather*}
        f(x) = \cos(x) \text{ for } -1 \leq x < 1.
    \end{gather*}
    Give the Fourier series in standard form and in complex notation. 
    Compare $F_3 f$ at the points $x = -\pi/4, 0, \pi/4$ with the original function $f$.
\end{exercise}
\begin{solution}    
We calculate the complex Fourier coefficients 
\begin{align*}
    c_0 = \frac 1 2 \int_{-1}^1 \cos x dx = \frac 1 2 [\sin x]_{-1}^1 = \sin 1
\end{align*}
\begin{align*}
    c_n &= \frac 1 2 \int_{-1}^1 \cos x e^{-\pi n x i} dx\\
    &= \frac 1 2 \int_{-1}^1 \left(\frac 1 2 e^{x i} + \frac 1 2 e^{-x i} \right) e^{-\pi n x i} dx\\
    &= \frac 1 2 \int_{-1}^1 \left(\frac 1 2 e^{(1-n\pi)x i} + \frac 1 2 e^{-(1+n\pi)x i} \right) dx\\
    &= \frac 1 2\left[\frac{1}{(1-n\pi) i}\frac 1 2 e^{(1-n\pi)x i} - \frac{1}{(1+n\pi) i}\frac 1 2 e^{-(1+n\pi)x i} \right]_{-1}^1\\
    &= \frac{1}{2(1-n\pi) i}\left( \frac 1 2 e^{(1-n\pi)i}- \frac 1 2 e^{-(1-n\pi) i}\right) - \frac{1}{2(1+n\pi) i}\left( \frac 1 2 e^{(1+n\pi)i}+ \frac 1 2 e^{-(1+n\pi) i}\right)\\
    &= \frac{1}{2(1-n\pi)}\sin(1-\pi n) + \frac{1}{2(1+n\pi)}\sin(1+\pi n)\\
\end{align*}
Using $c_n$ we can determine $a_n$ and $b_n$
$$
    \frac{a_0}{2} = c_0 = \sin 1,
    \quad 
    a_n = c_n + c_{-n} = \frac{1}{(1-n\pi)}\sin(1-\pi n) + \frac{1}{(1+n\pi)}\sin(1+\pi n),
    \\
    b_n = i(c_{-n} - c_{n}) = 0
$$
The Fourier series in standard and in complex notation are given by:
\begin{align*}
    F f(x)&=\sum_{n=-\infty}^{\infty} \left(\frac{1}{2(1-n\pi)}\sin(1-\pi n) + \frac{1}{2(1+n\pi)}\sin(1+\pi n)\right) e^{\frac{2 \pi n x}{T} i}
    \\
    F f(x)&=\sin(1)+\sum_{n=1}^{\infty} \left(  \frac{1}{(1-n\pi) }\sin(1-\pi n) + \frac{1}{(1+n\pi)}\sin(1+\pi n) \right) \cos \left(\pi n x\right)
\end{align*}
%use this command in wolfram "sin(1) + Sum[ (1/(1 - n*pi)*sin(1 - pi*n) + 1/(1 + n*pi)*sin(1 + pi*n))*cos(pi*n*x), {n, 1, 3}]"
We compare $F_3f(x)$ and $f(x)$ at several points 
\begin{gather*}
    F_3f(0) = 1.00664,\qquad 
    F_3f\left(-\frac{\pi}{4}\right) \approx 0.69196,\qquad 
    F_3f\left(\frac{\pi}{4}\right) \approx 0.69196,
    \\
    f(0) = 1,\qquad 
    f\left(-\frac{\pi}{4}\right) \approx 0.70711,\qquad
    f\left(\frac{\pi}{4}\right) \approx 0.70711.
\end{gather*}

\end{solution}






























\end{document}
