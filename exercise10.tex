\documentclass[11pt]{article}
\def\hidesolutions{}
\input{header}
\begin{document}
\exsheet{10}{21}{November} % parameters are the number of the session and the day




\begin{exercise}
    \begin{align*}
        ReLU(x) 
        &= \begin{cases} 0 & \text{ if } x < 0 \\ x & \text{ if } 0 \geq x \end{cases}
        \\
        ReLU^{k}(x) 
        &= \begin{cases} 0 & \text{ if } x < 0 \\ x^{k} & \text{ if } 0 \leq x \end{cases} \text{ where } k \in \mathbb N_0
        \\
        f(x) 
        &= 
        \begin{cases} 
            -x-2            & \text{ if } -2 < x < -1
            \\
            - x^{2} - 2x - 1 & \text{ if } -1 < x < 0 
            \\ 
              x^{2} + 2x - 1 & \text{ if } 0 <  x < 1
            \\
            2-x            & \text{ if }  1 < x < 2
            \\
            0              & \text{ otherwise }  
            % 
        \end{cases}
        .
    \end{align*}
    Here, employ the definition of distributional derivatives and check against the formula for piecewise differentiable functions as obtained during lecture. 
\end{exercise}
\begin{solution}
    \begin{itemize}
        \item For the $ReLU$ function, we have for any $\phi \in \mathcal D(\mathbb{R})$,
        \begin{align*}
            \langle ReLU', \phi \rangle = -\langle ReLU, \phi' \rangle = -\int_{-\infty}^{\infty} ReLU(x) \phi'(x) dx = -\int_{0}^{\infty} x \phi'(x) dx = \int_{0}^{\infty} \phi(x) dx = \langle H, \phi \rangle,
        \end{align*}
        where $H$ is the Heaviside step function. Thus, we conclude that $ReLU' = H$.
        \item For $k > 1$, we find for any $\phi \in \mathcal D(\mathbb{R})$,
        \begin{align*}
            \langle (ReLU^k)', \phi \rangle &= - \langle ReLU^k, \phi' \rangle = - \int_{-\infty}^{\infty} ReLU^k(x) \phi'(x) dx \\
            &= - \int_{0}^{\infty} x^k \phi'(x) dx = \int_{0}^{\infty} k x^{k-1} \phi(x) dx = \langle k ReLU^{k-1}, \phi \rangle.
        \end{align*}
        Therefore, we conclude that $(ReLU^k)' = k ReLU^{k-1}$.
        \item For the function $f$, we have for any $\phi \in \mathcal D(\mathbb{R})$,
        \begin{align*}
            \langle f', \phi \rangle &= - \langle f, \phi'\rangle = \int_{-2}^{-1}(x + 2) \phi'(x) dx + \int_{-1}^{0} (x^2 + 2x + 1) \phi'(x) dx\\
            &- \int_{0}^{1} (x^2 + 2x - 1) \phi'(x) dx + \int_{1}^{2} (x - 2) \phi'(x) dx \\
            &= \phi(-1) - \int_{-2}^{-1} \phi(x) dx + \phi(0) - \int_{-1}^{0} 2(x + 1) \phi(x)dx\\
            &- 2\phi(1)  - \phi(0) + \int_{0}^{1} 2(x + 1) \phi(x) dx + \phi(1) - \int_{1}^{2} \phi(x) dx \\
            &= \int_{-2}^{-1} (-1) \phi(x) dx + \int_{-1}^0 (-2(x + 1)) \phi(x) dx \\
            &+ \int_{0}^{1} 2(x + 1) \phi(x) dx + \int_{1}^{2} (-1) \phi(x) dx + \phi(-1) - \phi(1)\\
            &= \langle g + \delta_{-1} - \delta_{1} , \phi \rangle,
        \end{align*}
        where the function $g: \mathbb{R} \to \mathbb{R}$ is defined as
        \begin{align*}
            g(x) = \begin{cases} -1 & \text{ if } -2 < x \leq -1 \\ -2(x + 1) & \text{ if } -1 < x \leq 0 \\ 2(x + 1) & \text{ if } 0 < x \leq 1 \\ -1 & \text{ if } 1 < x \leq 2 \\ 0 & \text{ otherwise } \end{cases}.
        \end{align*}
        Hence, we conclude that $f' = g + \delta_{-1} - \delta_{1}$. Note that this corresponds exactly to the formula found during the lecture.
    \end{itemize}
\end{solution}
\begin{exercise}
    Compute the Fourier coefficients of the function $f$ that has period $T = 2\pi$ and satisfies
    \[
        f(x) = \left\{\begin{array}{ll} 1 & 0 \leq x < \pi \\ 0 & \pi < x \leq 2\pi \end{array}\right.
    \]
\end{exercise}
\begin{solution}     
    We notice that the period $T$ equals $T = 2\pi$. 
    We have defined the first coefficient to be just the average:
    \begin{align*}
        a_0 
        &= 
        \frac{1}{2\pi} \int_0^{2\pi} f(x) \, dx 
        = 
        \frac{1}{2\pi} \int_0^\pi \, dx  = \frac 1 2
        .
    \end{align*}
    For the other coefficients, we use the formulas from the lecture:
    \begin{align*}
        a_n 
        &= 
        \frac{2}{2\pi} \int_0^{2\pi} f(x) \cos\left(\frac{2\pi n x}{T}\right) \, dx 
        \\&= 
        \frac{2}{2\pi} \int_0^\pi \cos\left(\frac{2\pi n x}{T}\right) \, dx 
        \\
        &= 
        \frac{2}{2\pi} \left[ \frac{T}{2\pi n} \sin\left(\frac{2\pi n x}{T}\right) \right]_{x=0}^{x=\pi}
        \\&= 
        \frac{2}{2\pi} \frac{T}{2\pi n} \left( \sin\left(\frac{2\pi n \pi}{T}\right) - \sin(0) \right) 
        \\&= 
        \frac{2}{2\pi} \frac{2\pi}{2\pi n} \left( \sin\left(n \pi \right) - \sin(0) \right) 
        \\&= 
        0
    \end{align*}
    because $\sin$ equals zero at integer multiples of $\pi$.
    For the sine mode coefficients, we calculate similarly:
    \begin{align*}
        b_n 
        &= 
        \frac{2}{2\pi}
        \int_0^{2\pi} f(x) \sin(nx) \, dx 
        \\
        &= 
        \frac{1}{\pi}
        \int_0^\pi \sin(nx) \, dx 
        \\
        &= 
        \frac{1}{\pi}
        \left[-\frac{\cos(nx)}{n} \right]_{x=0}^{x=\pi} 
        \\
        &= 
        -
        \frac{1}{\pi}
        \frac{1}{n} \left[ \cos(n\pi) - \cos(0) \right] 
        \\
        &= 
        -
        \frac{1}{n\pi}
        \left[ (-1)^n - 1 \right] 
        \\
        &= 
        \frac{1}{n\pi}
        \begin{cases}
            0 & \text{if } n \text{ is even} 
            \\
            2 & \text{if } n \text{ is odd}
        \end{cases}
    \end{align*}
    Thus we find $a_0 = 0.5$ and $a_1 = a_2 = \dots = 0$,
    and either $b_n = 0$ if $n$ is even and $b_n = \frac{2}{n\pi}$ if $n$ is odd. 
\end{solution}


\begin{exercise}
    Let $f : \bbR \rightarrow \bbR$ be a function with period $1$ and 
    \begin{align*}
        f(x) = x, \qquad 0 < x < 1.
    \end{align*}
    Find the distributional derivative. 
\end{exercise}
\begin{solution}
    First, we note that we can express the function $f$ as
    \begin{align*}
        f(x) = \sum_{n \in \mathbb{Z}} 1_{[n, n+1)}(x) (x - n),
    \end{align*}
    where $1_{[n, n+1)}$ is the indicator function of the interval $[n, n+1)$.
    For a function $\phi \in \mathcal{D}(\mathbb{R})$, we have
    \begin{align*}
        \langle f', \phi \rangle &= - \langle f, \phi' \rangle = -\sum_{n \in \mathbb{Z}} \int_n^{n+1} (x - n) \phi'(x) dx = -\sum_{n \in \mathbb{Z}} \left[ \phi(n + 1) - \int_{-\infty}^\infty 1_{[n, n+1)}(x) \phi(x) dx\right]\\
        &= \int_{-\infty}^\infty \phi(x) dx - \sum_{n \in \mathbb{Z}} \phi(n) = \langle 1 - \Delta_1, \phi \rangle,
    \end{align*}
    where $\Delta_1$ is the Dirac comb with period $1$. Thus, we conclude that $f' = 1 - \Delta_1$. Note here, that the interchanging of the infinite sum and the integral is justified by the fact that the sum actually finite due to the finite support of $\phi$.
\end{solution}
\begin{exercise}
    Compute the Fourier coefficients of the following functions, which have period $T = 1$ and have the given values over the interval $[0,1)$:
    \begin{itemize}
     \item 
     \[
        f(x) = x^{2}
     \]
     \item 
     \[
        g(x) = (1-x)x
     \]
     \item 
     \[
        h(x) = |\sin( 2 \pi x )|
     \]
     %
    \end{itemize}
\end{exercise}
\begin{solution}     
    \begin{itemize}
        \item 
        To compute the Fourier coefficients of $f(x) = x^2$ over the interval $[0,1)$ with a period of $1$, use the formulas from the lecture:
        \[
            a_0 = \int_{0}^{1} f(x) dx  = \int_{0}^{1} x^2 dx  = \left[ \frac{x^3}{3} \right]_{0}^{1} = \frac 1 3.
        \]
        For other coefficients, we apply integration by parts twice, and we use that $\sin$ vanishes at multiples of $\pi$:
        \begin{align*}
            a_n 
            &
            = 
            \frac{2}{T}
            \int_{0}^{1} x^2 \cos(2\pi n x) dx
            \\&
            =
            \frac{2}{T}
            \left[ x^2 \frac{ \sin(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            -
            \frac{2}{T}
            \int_{0}^{1} \frac{ 2x \sin(2\pi n x) }{ 2\pi n } dx
            \\&
            =
            \frac{2}{T}
            \left[ x^2 \frac{ \sin(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            -
            \frac{4}{T}
            \int_{0}^{1} x \frac{ \sin(2\pi n x) }{ 2\pi n } dx
            \\&
            =
            \frac{2}{T}
            \left[ x^2 \frac{ \sin(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            -
            \frac{4}{T}
            \left[ x \frac{ -\cos(2\pi n x) }{ 4\pi^2 n^2 } \right]_{x=0}^{x=1}
            +
            \frac{4}{T}
            \int_{0}^{1} \frac{ -\cos(2\pi n x) }{ 4\pi^2 n^2 } dx
            \\&
            =
            \frac{2}{T}
            \left[ x^2 \frac{ \sin(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            -
            \frac{4}{T}
            \left[ x \frac{ -\cos(2\pi n x) }{ 4\pi^2 n^2 } \right]_{x=0}^{x=1}
            +
            \frac{4}{T}
            \left[ \frac{ -\sin(2\pi n x) }{ 8\pi^3 n^3 } \right]_{x=0}^{x=1}
            \\&
            = 
            \frac{1}{\pi^2 n^2}
        \end{align*}
        \begin{align*}
            b_n 
            &
            = 
            \frac{2}{T}
            \int_{0}^{1} x^2 \sin(2\pi n x) dx
            \\&
            =
            \frac{2}{T}
            \left[- x^2 \frac{ \cos(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{2}{T}
            \int_{0}^{1} \frac{ 2x \cos(2\pi n x) }{ 2\pi n } dx
            \\&
            =
            \frac{2}{T}
            \left[- x^2 \frac{ \cos(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{4}{T}
            \int_{0}^{1} \frac{ x \cos(2\pi n x) }{ 2\pi n } dx
            \\&
            =
            \frac{2}{T}
            \left[ -x^2 \frac{ \cos(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{4}{T}
            \left[ x \frac{ \sin(2\pi n x) }{ 4\pi^2 n^2 } \right]_{x=0}^{x=1}
            -
            \frac{4}{T}
            \int_{0}^{1} \frac{ \sin(2\pi n x) }{ 4\pi^2 n^2 } dx
            \\&
            =
            \frac{2}{T}
            \left[ -x^2 \frac{ \cos(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{4}{T}
            \left[ x \frac{ \sin(2\pi n x) }{ 4\pi^2 n^2 } \right]_{x=0}^{x=1}
            +
            \frac{4}{T}
            \left[ \frac{ \cos(2\pi n x) }{ 8\pi^3 n^3 } \right]_{x=0}^{x=1}
            \\&
            = 
            -\frac{2}{T}\frac{1}{2\pi n} + \frac{4}{T}\frac{1}{8\pi^3n^3} -  \frac{4}{T}\frac{1}{8\pi^3n^3} = -\frac{1}{\pi n}
        \end{align*}
        \item 
        We notice that the function $g(x) = (1-x)x$ can be written $g(x) = x - f(x)$ over the interval $[0,1)$. 
        In other words, $g$ is the difference of the sawtooth function (which equals $x$ over $[0,1)$ and repeats with period $T=1$),
        and the periodic function $f(x)$ seen earlier.
        
        We will only need to determine the Fourier coefficients of $\tilde{g}(x) = x$ since we already computed the Fourier coefficients of $f(x)$. 
        We calculate the average 
        \[
            a_0^{\tilde g} = \int_{0}^{1} \tilde{g}(x) dx  = \int_{0}^{1} x dx  = \left[ \frac{x^2}{2} \right]_{0}^{1} = \frac 1 2.
        \]
        We calculate 
        \begin{align*}
            a_n^{\tilde g} 
            &
            = 
            \frac{2}{T}
            \int_{0}^{1} x \cos(2\pi n x) dx
            \\&
            =
            \frac{2}{T}
            \left[ x \frac{ \sin(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            -
            \frac{2}{T}
            \int_{0}^{1} \frac{ \sin(2\pi n x) }{ 2\pi n } dx
            \\&
            =
            \frac{2}{T}
            \left[ x \frac{ \sin(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{2}{T}
            \left[ \frac{ \cos(2\pi n x) }{ 4\pi^2 n^2 } \right]_{x=0}^{x=1}
            \\&
            =
            \frac{2}{T}
            \frac{1}{2\pi n}
            \left( \sin(2\pi n) - \sin(0) \right)
            +
            \frac{2}{T}
            \frac{1}{ 4\pi^2 n^2 }
            \left( \cos(2\pi n) - \cos(0) \right)
            \\&
            =
            0
        \end{align*}	
        Lastly, 
        \begin{align*}
            b_n^{\tilde g} 
            &
            = 
            \frac{2}{T}
            \int_{0}^{1} x \sin(2\pi n x) dx
            \\&
            =
            \frac{2}{T}
            \left[- x \frac{ \cos(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{2}{T}
            \int_{0}^{1} \frac{ \cos(2\pi n x) }{ 2\pi n } dx
            \\&
            =
           \frac{2}{T}
            \left[- x \frac{ \cos(2\pi n x) }{ 2\pi n } \right]_{x=0}^{x=1}
            +
            \frac{2}{T}
            \left[ \frac{ \sin(2\pi n x) }{ 4\pi^2 n^2 } \right]_{x=0}^{x=1}
            \\&
            = 
            -\frac{2}{T}\frac{1}{2\pi n} =  -\frac{1}{\pi n} 
        \end{align*}	
        Now the Fourier coefficients of $g(x)$ are given by
                \begin{align*}
                    &b_n = -\frac{1}{\pi n} - - \frac{1}{\pi n} = 0
                    \\& 
            a_n = 0 - \frac{1}{2\pi^2 n^2} =  - \frac{1}{\pi^2 n^2} 
                    \\&
            a_0 = \frac{1}{2} - \frac{1}{3} = \frac{1}{6}
        \end{align*}	
        \item
        Note that $h(x)$ is an even function.
        Therefore $b_n = 0$. 
        We calculate the average 
        \[
            a_0 
            = 
            \frac{1}{T} \int_{0}^{1} |\sin 2\pi x| dx  
            = 
            \frac{2}{T} \int_{0}^{\frac 1 2} \sin 2\pi x dx  
            =  
            \frac 2 T
            \left[ \frac{-1}{2\pi} \cos{2\pi x} \right]_{0}^{\frac 1 2} 
            =
            \frac{2}{\pi} 
            .
        \]
        The coefficients $a_n$ for the cosine modes with $n \geq 1$ are:
        \begin{align*}
            a_n 
            &
            = 
            \frac{4}{T}
            \int_{0}^{\frac 1 2} \sin 2\pi x \cos(2\pi n x) dx
            \\&
            =
            \frac{4}{T}
            \int_{0}^{\frac 1 2} \frac 1 2 \sin{2\pi(1-n)x} + \frac 1 2 \sin{2\pi(n+1)x} dx
            \\&
		=
            \frac{4}{T}
            \int_{0}^{\frac 1 2} -\frac 1 2 \sin{2\pi(n-1)x} + \frac 1 2 \sin{2\pi(n+1)x} dx
            \\&
            =
            \left[\frac{ \cos2\pi(n-1)x }{ \pi(n-1) } \right]_{x=0}^{x=\frac 1 2}
            +
            \left[- \frac{ \cos2\pi(n+1)x }{ \pi(n+1) } \right]_{x=0}^{x=\frac 1 2}
            \\&
            = 
            \frac{(-1)^{n-1}}{\pi(n-1)} -  \frac{1}{\pi(n-1)}  - \frac{(-1)^{n+1}}{\pi(n+1)} + \frac{1}{\pi(n+1)}
            \\&
            = -\frac{1+(-1)^{n}}{\pi(n-1)} +  \frac{1-(-1)^{n+1}}{\pi(n+1)} 
            \\&
            = -\frac{1+(-1)^{n}}{\pi(n-1)} +  \frac{1+(-1)^{n}}{\pi(n+1)} 
        \end{align*}	
        Therefore, when $n \geq 1$:
        \[a_n = 
        \begin{cases}
        0 ,\quad &\text{if } n\text{ is odd,}\\
        -\frac{2}{\pi(n-1)} + \frac{2}{\pi(n+1)}  ,\quad &\text{if } n\text{ is even,}
        \end{cases}
        \]
       \end{itemize}
\end{solution}

\begin{exercise}
    Compute the Fourier coefficients of the following functions, which have period $T = 2\pi$ and have the given values over the interval $[0,2\pi)$:
    \begin{itemize}
     \item 
     \[
        f(x) = e^{x - \pi}
     \]
     \item 
     \[
        g(x) = {(x - \pi)^3}
     \]
     \item 
     \[
        h(x) = \left\{\begin{array}{ll}
            \sin(x) & 0 \leq x < \frac \pi 2
            \\
            0   & \frac \pi 2 \leq x < \frac{3\pi}{2} 
            \\
            \sin(x) & \frac {3\pi} 2 \leq x < 2\pi
        \end{array}\right.
     \]
     %
    \end{itemize}
\end{exercise}
\begin{solution}     
    \begin{itemize}
    \item To compute the Fourier coefficients of $f(x)$ with a period of $2\pi$, use the formulas from the lecture:
    \[
        a_0 
        = 
        \frac{1}{2\pi}\int_{0}^{2\pi} f(x) dx  = \frac{1}{2\pi}\int_{0}^{2\pi} e^{x-\pi} dx  = \frac{1}{2\pi}\left[ e^{x-\pi} \right]_{0}^{2\pi} = \frac{1}{\pi}\left(e^{\pi} - e^{-\pi}\right)
    \]
    For other coefficients, we apply integration by parts twice, and see that we obtain the same integral again:
    \begin{align*}
        a_n 
        &
        = 
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x - \pi} \cos( n x) dx
        \\&
        =
        \frac{1}{\pi}
        \left[ e^{x - \pi} \frac{ \sin(n x) }{ n } \right]_{x=0}^{x=2\pi}
        -
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ \sin( n x) }{ n } dx
        \\&
        =
        \frac{1}{\pi}
        \left[ e^{x - \pi} \frac{ \sin(n x) }{ n } \right]_{x=0}^{x=2\pi}
        -
        \frac{1}{\pi}
        \left[ e^{x - \pi} \frac{ -\cos(n x) }{ n^2 } \right]_{x=0}^{x=2\pi}
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ -\cos(n x) }{ n^2 } dx
        \\&
        =
        \frac{1}{\pi}
        \left( e^{\pi} \frac{ \sin(2\pi x) }{ n } - e^{0 - \pi} \frac{ \sin(n 0) }{ n } \right)
        -
        \frac{1}{\pi}
        \left( e^{\pi} \frac{ -\cos(n 2\pi) }{ n^2 } - e^{- \pi} \frac{ -\cos(n 0) }{ n^2 } \right)
        \\&\qquad\qquad
        +
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ -\cos(n x) }{ n^2 } dx
        \\&
        =
        \frac{1}{\pi}\frac{e^{\pi} - e^{-\pi}}{n^2}
        +
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ -\cos(n x) }{ n^2 } dx
        \\&
        =
        \frac{1}{\pi}\frac{e^{\pi} - e^{-\pi}}{n^2}
        -
        \frac{1}{\pi}
        \int_{0}^{2\pi} e^{x-\pi}\frac{ \cos(n x) }{ n^2 } dx
        \end{align*}
        We rearrange that 
        \begin{align*}
            \int_{0}^{2\pi} e^{x-\pi} \cos(n x) dx
            &=
            \frac{e^{\pi} - e^{-\pi}}{ n^2}
            -
            \frac{1}{n^2}
            \int_{0}^{2\pi} e^{x-\pi} \cos(n x) dx
            \\
            \implies\qquad 
            \left( 1 + \frac 1 {n^2} \right)
            \int_{0}^{2\pi} e^{x-\pi} \cos(n x) dx
            &=
            \frac{e^{\pi} - e^{-\pi}}{ n^2}
            \\
            \implies\qquad 
            \int_{0}^{2\pi} e^{x-\pi} \cos(n x) dx
            &=
            \left( 1 + \frac 1 {n^2} \right)^{-1}
            \frac{e^{\pi} - e^{-\pi}}{ n^2}
            .   
        \end{align*}
        We conclude that 
        \begin{align*}
            a_n := 
            \frac{1}{\pi}
            \int_{0}^{2\pi} e^{x - \pi} \cos( n x) dx 
            &= 
            \left( 1 + \frac 1 {n^2} \right)^{-1}
            \frac{e^{\pi} - e^{-\pi}}{\pi n^2}
            \\&= 
            \left( \frac {n^2+ 1} {n^2} \right)^{-1}
            \frac{e^{\pi} - e^{-\pi}}{\pi n^2}
            \\&= 
            \frac{n^2}{1+n^2}
            \frac{e^{\pi} - e^{-\pi}}{\pi n^2}
            \\&= 
            \frac{e^{\pi} - e^{-\pi}}{(1+n^2)\pi}
        \end{align*}
        The coefficients of the sine modes are:
        \begin{align*}
            b_n 
            &
            = 
            \frac{1}{\pi}
            \int_{0}^{2\pi} e^{x - \pi} \sin(n x) dx
            \\&
            =
            \frac{1}{\pi}
            \left[- e^{x - \pi} \frac{ \cos( n x) }{ n } \right]_{x=0}^{x=2\pi}
            +
            \frac{1}{\pi}
            \int_{0}^{2\pi} \frac{ e^{x - \pi} \cos( n x) }{ n } dx
            \\&
            =
            \frac{1}{\pi}
             \left[- e^{x - \pi} \frac{ \cos( n x) }{ n } \right]_{x=0}^{x=2\pi}
            +
            \frac{1}{\pi}
            \left[ e^{x-\pi} \frac{ \sin(n x) }{ n^2 } \right]_{x=0}^{x=2\pi}
            -
            \frac{1}{\pi}
            \int_{0}^{2\pi} e^{x-\pi}\frac{ \sin(n x) }{n^2 } dx
            \\&
            =
            \frac{1}{\pi}\frac{e^{-\pi} - e^{\pi}}{n}
            -
            \frac{1}{\pi}
            \int_{0}^{2\pi} e^{x-\pi}\frac{ \sin(n x) }{n^2 } dx
        \end{align*}
        Similar as above, it follows that 
        \begin{align*}
            b_n:= \frac{1}{\pi}
                    \int_{0}^{2\pi} e^{x - \pi} \sin(n x) dx = \frac{1}{1 + \frac{1}{n^2}} \frac{1}{\pi}\frac{e^{-\pi} - e^{\pi}}{n} = \frac{1}{\pi}  \frac{e^{-\pi} - e^{\pi}}{n + \frac{1}{n}}
        \end{align*}
    %subquestion 2
    \item
% <<<<<<< HEAD
    We compute the average 
    \begin{align*}
        a_0
        :=
        \frac{1}{2\pi} \int_{0}^{2\pi} (x-\pi)^{3} dx
        =
        \frac{1}{2\pi} \int_{-\pi}^{\pi} z^{3} dz
        =
        0
        .
    \end{align*}
    We compute the coefficients of the cosine modes: for $n \geq 1$, we find 
    \begin{align*}
        a_n
        &:=
        \frac{2}{2\pi} \int_{0}^{2\pi} (x-\pi)^{3} \cos(nx) dx
        \\&=
        \frac{1}{\pi} \int_{0}^{2\pi} (x-\pi)^{3} \cos(nx) dx
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \cos(n(z+\pi)) dz
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \cos(nz+n\pi)) dz
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \cos(nz)) dz
        \cdot \left\{\begin{array}{ll} 1 & \text{ if $n$ is even } \\ -1 & \text{ if $n$ is odd } \end{array}\right.
        .
    \end{align*}
    However, $z^3 \cos(nz)$ is the product of an odd and an even function, and so the integral vanishes. 
    Explicitly:
    \begin{align*}
        \int_{-\pi}^{\pi} z^{3} \cos(nz)) dz
        &=
        \int_{-\pi}^{0} z^{3} \cos(nz)) dz
        + 
        \int_{0}^{\pi} z^{3} \cos(nz)) dz
        \\&=
        - 
        \int_{0}^{\pi} w^{3} \cos(nw)) dw
        + 
        \int_{0}^{\pi} z^{3} \cos(nz)) dz
        = 
        0.
    \end{align*}
    Finally, we compute the coefficients of the sine modes:
    \begin{align*}
        b_n
        &:=
        \frac{2}{2\pi} \int_{0}^{2\pi} (x-\pi)^{3} \sin(nx) dx
        \\&=
        \frac{1}{\pi} \int_{0}^{2\pi} (x-\pi)^{3} \sin(nx) dx
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \sin(n(z+\pi)) dx
        \\&=
        \frac{1}{\pi} \int_{-\pi}^{\pi} z^{3} \sin(nz) dz
        \cdot \left\{\begin{array}{ll} 1 & \text{ if $n$ is even } \\ -1 & \text{ if $n$ is odd } \end{array}\right.
        .
    \end{align*}
    In either case, since $z^3$ and $\sin(nz)$ are odd functions,
    \begin{align*}
        \int_{-\pi}^{\pi} z^{3} \sin(nz) dz
        &=
        2\int_{0}^{\pi} z^{3} \sin(nz) dz
        .
    \end{align*}
    We perform integration by parts several times:
    \begin{align*}
        &
        \int_{0}^{\pi} z^{3} \sin(nz) dz
        \\&=
        -
        \frac 1 {n} 
        \left[ z^{3} \cos(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 3 {n}
        \int_{0}^{\pi} z^{2} \cos(nz) dz
        \\&=
        -
        \frac 1 {n} 
        \left[ z^{3} \cos(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 3 {n^2} 
        \left[ z^{2} \sin(nz) \right]_{z=0}^{z=\pi}
        -
        \frac 6 {n^2} 
        \int_{0}^{\pi} z \sin(nz) dz
        \\&=
        - \frac 1 {n} 
        \left[ z^{3} \cos(nz) \right]_{z=0}^{z=\pi}
        + 
        \frac 3 {n^2}
        \left[ z^{2} \sin(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 6 {n^3} 
        \left[ z \cos(nz) \right]_{z=0}^{z=\pi}
        -
        \frac 6 {n^3} 
        \int_{0}^{\pi} \cos(nz) dz
        \\&=
        - \frac 1 {n} 
        \left[ z^{3} \cos(nz) \right]_{z=0}^{z=\pi}
        + 
        \frac 3 {n^2}
        \left[ z^{2} \sin(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 6 {n^3} 
        \left[ z \cos(nz) \right]_{z=0}^{z=\pi}
        +
        \frac 6 {n^4} 
        \left[ \sin(nz) \right]_{z=0}^{z=\pi}
        \\&=
	-\frac{\pi^3(-1)^n}{n}+\frac{6\pi(-1)^n}{n^3} 
	\\&\implies
            b_n = 
            \begin{cases}
            \frac{2\pi^2}{n}-\frac{12}{n^3}  ,\quad &\text{if } n\text{ is odd,}\\
            -\frac{2\pi^2}{n}+\frac{12}{n^3}   ,\quad &\text{if } n\text{ is even,}
            \end{cases}\cdot \left\{\begin{array}{ll} -1 & \text{ if $n$ is odd } \\ 1 & \text{ if $n$ is even } \end{array}\right. =  -\frac{2\pi^2}{n}+\frac{12}{n^3}
    \end{align*}
% 
% 
% =======
% To compute the Fourier coefficients of $g(x)$ over the interval $[0,2\pi)$ with a period of $2\pi$, we use the formulas from the lecture:
%         \[
%             a_0 = \frac{1}{2\pi}\int_{0}^{2\pi} f(x) dx  = \frac{1}{2\pi}\int_{0}^{2\pi} (x-\pi)^3 dx  = \left[ \frac{(x-\pi)^4}{4} \right]_{0}^{2\pi} = \frac{1}{2\pi}\frac 1 4 \pi^4 - \frac{1}{2\pi}\frac 1 4 (-\pi)^4 = 0.
%         \]
%         Note that the function is odd therefore $a_n = 0$. For $b_n$, we apply integration by parts thrice, and we use that $\sin$ vanishes at multiples of $\pi$:
%         \begin{align*}
%             b_n 
%             &
%             = 
%             \frac{2}{2\pi}
%             \int_{0}^{2\pi} (x-\pi)^3 \sin(n x) dx
%             \\&
%             =
%             \frac{2}{\pi}
%             \int_{0}^{\pi} (x-\pi)^3 \sin(n x) dx
%             \\&
%             =
%             \frac{2}{\pi}
%             \left[- (x-\pi)^3 \frac{ \cos(n x) }{n } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \int_{0}^{\pi} \frac{ 3(x-\pi)^2 \cos(n x) }{ n } dx
%             \\&
%             =
%  		\frac{2}{\pi}
%             \left[- (x-\pi)^3 \frac{ \cos(n x) }{n } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 3(x-\pi)^2 \frac{ \sin(n x) }{ n^2 } \right]_{x=0}^{x=\pi}
%             -
%             \frac{2}{\pi}
%             \int_{0}^{\pi} 6(x-\pi)\frac{ \sin( n x) }{n^2 } dx
%             \\&
%             =
%             \frac{2}{\pi}
%             \left[- (x-\pi)^3 \frac{ \cos(n x) }{n } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 3(x-\pi)^2 \frac{ \sin(n x) }{ n^2 } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 6(x-\pi)\frac{ \cos( n x) }{ n^3 } \right]_{x=0}^{x=\pi}
% 		-
%             \frac{2}{\pi}
%             \int_{0}^{\pi} 6\frac{ \cos( n x) }{ n^3 } dx
%             \\&
%             =
%  		\frac{2}{\pi}
%             \left[- (x-\pi)^3 \frac{ \cos(n x) }{n } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 3(x-\pi)^2 \frac{ \sin(n x) }{ n^2 } \right]_{x=0}^{x=\pi}
%             -
%             \frac{2}{\pi}
%             \int_{0}^{\pi} 6(x-\pi)\frac{ \sin( n x) }{n^2 } dx
%             \\&
%             =
%             \frac{2}{\pi}
%             \left[- (x-\pi)^3 \frac{ \cos(n x) }{n } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 3(x-\pi)^2 \frac{ \sin(n x) }{ n^2 } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 6(x-\pi)\frac{ \cos( n x) }{ n^3 } \right]_{x=0}^{x=\pi}
% 		-
%             \frac{2}{\pi}
%             \left[ 6\frac{ \sin( n x) }{ n^3 } \right]_{x=0}^{x=\pi}
% 		\\&
%             =\frac{2}{\pi}
%             \left[- (x-\pi)^3 \frac{ \cos(n x) }{n } \right]_{x=0}^{x=\pi}
%             +
%             \frac{2}{\pi}
%             \left[ 6(x-\pi)\frac{ \cos( n x) }{ n^3 } \right]_{x=0}^{x=\pi}
% 		\\&
% 		= -\frac{2\pi^2}{n}+\frac{12}{n^3}
%         \end{align*}
% >>>>>>> 602337bdc4aee219b2f971dc33945611c0773aed
    %subquestion 3
    \item 
    The average of $h(x)$ over $1$ period $T$ is $0$ therefore:
    \[
        a_0 = 0
    \]
    Moreover $h(x)$ is odd therefore $a_n = 0$. For $b_n$ we have:
    \begin{align*}
        b_n 
        &
        = 
        \frac{2}{2\pi}
        \int_{0}^{\frac{\pi}{2}} \sin(x) \sin(n x) dx
        +
        \frac{2}{2\pi}
        \int_{\frac{3\pi}{2}}^{2\pi} \sin(x) \sin(n x) dx
        \\&
        =
        \frac{2}{2\pi}
        \int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} \sin(x) \sin(n x) dx
        \\&
        =
        \frac{1}{\pi}
        \int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} \sin(x) \sin(n x) dx
        \\&
        =
        \frac{2}{\pi}
        \int_{0}^{\frac{\pi}{2}} \sin(x) \sin(n x) dx
        \\&
        =
        \frac{1}{\pi}
        \int_{0}^{\frac{\pi}{2}} \cos((n-1)x) - \cos((n+1)x) dx
        \\&
        =
        \frac{1}{\pi}
        \left[ \frac{\sin((n-1)x)}{n-1} - \frac{\sin((n+1)x)}{n+1}\right]_{x=0}^{x=\frac{\pi}{2}}
        \\&
        =
        \frac{\sin((n-1)\frac{\pi}{2})}{n-1} - \frac{\sin((n+1)\frac{\pi}{2})}{n+1}
    \end{align*}
    If $n$ is odd, then $n-1$ and $n+1$ are both even, and so $(n-1)\frac{\pi}{2}$ and $(n+1)\frac{\pi}{2}$ will be integer multiples of $\pi$. 
    Hence $b_n$ is zero if $n$ is odd. 
    For the even numbers, we have got another case distinction:
    if $n=1,5,9,\dots$, then 
    \begin{align*}
        b_n = \frac{1}{n-1} - \frac{-1}{n+1} = \frac{1}{n-1} + \frac{1}{n+1} = \frac{n+1+n-1}{n^2+1} = \frac{2n}{n^2+1}.
    \end{align*}
    if $n=3,7,11,\dots$, then 
    \begin{align*}
        b_n = \frac{-1}{n-1} - \frac{1}{n+1} = \frac{-n-1-n+1}{n^2+1} = \frac{-2n}{n^2+1}.
    \end{align*}
    

    
\end{itemize}
\end{solution}


\begin{exercise}
    Compute the Fourier coefficients of the function $f$ with period $T = 2\pi$ and which satisfies 
     \[
        f(x) = \sin(x) \text{ if } 0 \leq x  < \pi,
     \]
     and 
     \[
        f(x) = f(-x) \text{ for all } x \in \mathbb R.
     \]
\end{exercise}
\begin{solution}     
    Note that $f(x)$ is an even function,
    therefore $b_n = 0$. 
    The average is 
	\[
        a_0 = \frac{2}{2\pi} \int_{0}^{\pi} \sin x dx  =  \frac{1}{\pi}\left[ - \cos{x} \right]_{0}^{\pi} =\frac{2}{\pi} .
    \]
    The cosine mode coefficients are:
    \begin{align*}
            a_n 
            &
            = 
            \frac{2}{T}
            \int_{-\pi}^{\pi} f(x)   \cos(n x) dx
            \\&
            = 
            \frac{4}{T}
            \int_{0}^{\pi} \sin x \cos(n x) dx
            \\&
            =
            \frac{4}{T}
            \int_{0}^{\pi} \frac 1 2 \sin((1-n)x) + \frac 1 2 \sin((n+1)x) dx
            \\&
            =
            \frac{2}{T}
            \int_{0}^{\pi} \sin((1-n)x) + \sin((n+1)x) dx
            \\&
            =
            \frac{2}{T}
            \int_{0}^{\pi} -\sin((n-1)x) + \sin((n+1)x) dx
            \\&
            =
            \frac{2}{T}
            \left[\frac{ \cos((n-1)x) }{ (n-1) } \right]_{x=0}^{x=\pi}
            +
            \frac{2}{T}
            \left[- \frac{ \cos((n+1)x) }{ (n+1) } \right]_{x=0}^{x=\pi}
            \\&
            = 
            \frac 2 T 
            \left( 
                \frac{ \cos((n-1)\pi) }{(n-1)} 
                - 
                \frac{1}{(n-1)}
                -
                \frac{ \cos((n+1)\pi) }{(n+1)} 
                + 
                \frac{1}{(n+1)}
            \right)
            \\&
            = 
            \frac 2 T 
            \left( 
                \frac{ \cos( n \pi - \pi ) }{(n-1)} 
                - 
                \frac{1}{(n-1)}
                -
                \frac{ \cos( n \pi + \pi ) }{(n+1)} 
                + 
                \frac{1}{(n+1)}
            \right)
            \\&
            = 
            \frac 2 T 
            \left( 
                -
                \frac{ \cos(n\pi) }{(n-1)} 
                - 
                \frac{1}{(n-1)}
                +
                \frac{ \cos(n\pi) }{(n+1)} 
                + 
                \frac{1}{(n+1)}
            \right)
            \\&
            = 
            \frac 2 T 
            \left( 
                -
                \frac{ (-1)^n }{(n-1)} 
                - 
                \frac{1}{(n-1)}
                +
                \frac{ (-1)^n }{(n+1)} 
                + 
                \frac{1}{(n+1)}
            \right)
            \\&
            = 
            \frac 2 T 
            \left( 
                \frac{ 1 + (-1)^n }{(n+1)} 
                -
                \frac{ 1 + (-1)^n }{(n-1)} 
            \right)
            \\&
            = 
            \frac 1 \pi 
            \left( 
                \frac{ 1 + (-1)^n }{(n+1)} 
                -
                \frac{ 1 + (-1)^n }{(n-1)} 
            \right)
            .
        \end{align*}	
        Here, if $n$ is odd, the coefficient numerators are $1 + (-1) = 0$, and if $n$ is even, they are both equal $2$. Thus:
        \[
            a_n = 
            \begin{cases}
            0 ,\quad &\text{if } n\text{ is odd,}\\
            -\frac{2}{\pi(n-1)} + \frac{2}{\pi(n+1)}  ,\quad &\text{if } n\text{ is even,}
            \end{cases}
        \]
\end{solution}








\begin{exercise}
    Use Dirichlet's theorem to explain whether the Fourier series converges at $x \in [0,T]$ and to which value:
    \begin{itemize}
     \item \begin{gather*}
            f(x) = \left\{\begin{array}{ll}
                            x   & \text{ if $0 \leq x < 1$ }
                            \\
                            2 - x & \text{ if $1 \leq x < 2$ }
                          \end{array}\right., \qquad T = 2.
           \end{gather*}
     \item \begin{gather*}
            f(x) = \left\{\begin{array}{ll}
                            \pi   & \text{ if $0 \leq x < 1$ }
                            \\
                            e^{x-1} & \text{ if $1 \leq x < 2$ }
                            \\
                            \sin(x) & \text{ if $2 \leq x < 3$ }
                          \end{array}\right., \qquad T = 3.
           \end{gather*}
    \end{itemize}
    Here, the functions have the given period $T$.
\end{exercise}
\begin{solution}     
\begin{itemize}
\item $f$ is continuous and finite on the closed interval $[0,2]$ therefore the Fourier series, $F_N f$, converges to $f$ when we take the limit of $N$ going to $\infty$.
\item $f$ is continuous and finite on the closed intervals $[0,1]$, $[1,2]$ and $[2,3]$. However note that $f$ is not continuous in $f(0)$, $f(1)$ and $f(2)$ therefore the Fourier series, $F_N f$, converges to: 

\begin{gather*}
            g(x) = \left\{\begin{array}{ll}
                            \frac{\sin(3) + \pi}{2} & \text{ if $x = 0$ }
						\\
                            \pi   & \text{ if $0 < x < 1$ }
                            \\
                            \frac{\pi + 1}{2} & \text{ if $x = 1$ }
						\\
                            e^{x-1} & \text{ if $1 < x < 2$ }
						\\
                            \frac{\sin(2) + e^1}{2} & \text{ if $x = 2$ }
						\\
                            \sin(x) & \text{ if $2 < x < 3$ }
						\\
                            \frac{\sin(3) + \pi}{2} & \text{ if $x = 3$ }
                          \end{array}\right., \qquad T = 3.
\end{gather*}

when we take the limit of $N$ going to $\infty$.
\end{itemize}
\end{solution}

\begin{exercise}
    Give the Fourier series in complex notation, when $f$ has period $T = 2$ and 
    \begin{gather*}
        f(x) = x \text{ for } 0 \leq x < 2.
    \end{gather*}
\end{exercise}
\begin{solution}     
We can re-use the results from Lecture 8 slide 37, the sawtooth wave.

\begin{equation*}
g(x)=x \text { for } 0 \leq x<1
\end{equation*}

\begin{equation*}
a_0^g = \frac{1}{2},\quad a_n^g = 0, \quad b_n^g = \frac{-1}{\pi n}
\end{equation*}

Moreover we can write $f$ in terms of $g$ by introducing $x = \frac{y}{2}$

$$
f(y) = 2g(y/2)
$$

which gives us the fourier coefficients of $f$

\begin{equation*}
a_0^f = 1,\quad a_n^f = 0, \quad b_n^f = \frac{-2}{\pi n}
\end{equation*}

Using this we can obtain the fourier coefficients $c_n$:

$$
c_0 = a_0 = 1,\quad c_n=\frac{a_n}{2}-\frac{b_n}{2} i = \frac{1}{n\pi}i, \quad c_{-n}=\frac{a_n}{2}+\frac{b_n}{2} i = -\frac{1}{n\pi}i
$$

such that 

$$
F f(x)=\sum_{n=-\infty}^{\infty} c_n e^{\pi n x i}
$$
\end{solution}

\begin{exercise}
    Find the Fourier coefficients of $\cos(x)^8$ with period $T = 2\pi$.
    Use Parseval's identity to compute $\int_0^{2\pi} \cos(x)^{16} dx$.
\end{exercise}
\begin{solution}     
We will not use the standard approach in integrating the function $f$. Instead we try to rewrite $f$ as sum of $\cos(nx)$ using trigonometric formulas:
\begin{align*}
\cos^2\alpha &= \frac 1 2 + \frac 1 2 \cos 2 \alpha\\
\cos\alpha\cos\beta &= \frac 1 2 \cos (\alpha-\beta)+ \frac 1 2 \cos (\alpha + \beta) \\
\end{align*}
Using these formulas we can rewrite $f$ as follows:

\begin{align*}
\cos^8x &= (\cos^2x)^4\\
&= (\frac 1 2 + \frac 1 2 \cos 2x)^4\\
&= ((\frac 1 2 + \frac 1 2 \cos 2x)^2)^2\\
&= (\frac 1 4 + \frac 1 2 \cos 2x + \frac 1 4 \cos ^2 2 x)^2\\
&= (\frac 1 4 + \frac 1 2 \cos 2x + \frac 1 4 \cos ^2 2 x)^2\\
&= (\frac 1 4 + \frac 1 2 \cos 2x + \frac 1 4 \cos ^2 2x)(\frac 1 4 + \frac 1 2 \cos 2x + \frac 1 4 \cos ^2 2x)\\
&= \frac{1}{16}+\frac 1 4 \cos 2x + \frac 3 8 \cos^2 2x + \frac 1 4 \cos^3 2x +\frac{1}{16} \cos^4 2x\\
&= \frac{1}{16}+\frac 1 4 \cos 2x + \frac 3 8 (\frac 1 2 + \frac 1 2 \cos 4x) + \frac 1 4 \cos^3 2x +\frac{1}{16} \cos^4 2x\\
&= \frac{4}{16}+\frac 1 4 \cos 2x + \frac{3}{16} \cos 4x + \frac 1 4 \cos^3 2x +\frac{1}{16} \cos^4 2x\\
\end{align*}

Now we consider $\cos^3 2x$ and $\cos^4 2x$ seperately:

\begin{align*}
\cos^3 2x &= \cos 2x \cos^2 2x\\
&= (\frac 1 2 + \frac 1 2 \cos 4x) \cos 2x\\
&= \frac 1 2 \cos 2x + \frac 1 2 \cos 4 x \cos 2 x \\
&= \frac 1 2 \cos 2x + \frac 1 4 \cos 6 x  + \frac 1 4 \cos 2 x \\
&= \frac 3 4 \cos 2x + \frac 1 4 \cos 6 x \\
\end{align*}

\begin{align*}
\cos^4 2x &= (\cos^2 2x)^2\\
&=(\frac 1 2 + \frac 1 2 \cos 4x)^2\\
&= \frac 1 4 + \frac 1 2 \cos 4x + \frac 1 4 \cos^2 4x\\
&= \frac 1 4 + \frac 1 2 \cos 4x + \frac 1 4 (\frac 1 2 + \frac 1 2 \cos 8x)\\
&= \frac 3 8 + \frac 1 2 \cos 4x + \frac 1 8 \cos 8x\\
\end{align*}

putting everything together we have:

$$
\cos^8x  = \frac{35}{128} + \frac{7}{16}\cos 2x + \frac{7}{32}\cos 4x + \frac{1}{16} \cos 6x + \frac{1}{128}\cos 8x
$$

For the second part we use Parseval's identity which is given by: 

$$
\frac{2}{T} \int_0^T f(x)^2 d x=2 a_0^2+\sum_{n=0}^{\infty}\left(a_n\right)^2+\left(b_n\right)^2
$$

substituting our fourier coefficients and $f$ gives: 

\begin{align*}
\frac{2}{T} \int_0^T f(x)^2 d x&=2 a_0+\sum_{n=0}^{\infty}\left(a_n\right)^2+\left(b_n\right)^2\\
\frac{1}{\pi} \int_0^{2\pi} \cos(x)^{16} d x&= 2\left(\frac{35}{128}\right)^2 + \left(\frac{7}{16}\right)^2 + \left(\frac{7}{32}\right)^2 + \left(\frac{1}{16}\right)^2 + \left(\frac{1}{128}\right)^2.\\
\implies \int_0^{2\pi} \cos(x)^{16} d x&= \pi\left(2\left(\frac{35}{128}\right)^2 + \left(\frac{7}{16}\right)^2 + \left(\frac{7}{32}\right)^2 + \left(\frac{1}{16}\right)^2 + \left(\frac{1}{128}\right)^2\right) = \pi\frac 6435 16384 \approx 1.2339\\
\end{align*}

\end{solution}

\begin{exercise}
    Give the Fourier series of the function $f$ with period $T = 2$ and 
    \begin{gather*}
        f(x) = \cos(x) \text{ for } -1 \leq x < 1.
    \end{gather*}
    Give the Fourier series in standard form and in complex notation. 
    Compare $F_3 f$ at the points $x = -\pi/4, 0, \pi/4$ with the original function $f$.
\end{exercise}
\begin{solution}    
We calculate the complex fourier coefficients 
\begin{align*}
c_0 = \frac 1 2 \int_{-1}^1 \cos x dx = \frac 1 2 [\sin x]_{-1}^1 = \sin 1
\end{align*}

\begin{align*}
c_n &= \frac 1 2 \int_{-1}^1 \cos x e^{-\pi n x i} dx\\
&= \frac 1 2 \int_{-1}^1 \left(\frac 1 2 e^{x i} + \frac 1 2 e^{-x i} \right) e^{-\pi n x i} dx\\
&= \frac 1 2 \int_{-1}^1 \left(\frac 1 2 e^{(1-n\pi)x i} + \frac 1 2 e^{-(1+n\pi)x i} \right) dx\\
&= \frac 1 2\left[\frac{1}{(1-n\pi) i}\frac 1 2 e^{(1-n\pi)x i} - \frac{1}{(1+n\pi) i}\frac 1 2 e^{-(1+n\pi)x i} \right]_{-1}^1\\
&= \frac{1}{2(1-n\pi) i}\left( \frac 1 2 e^{(1-n\pi)i}- \frac 1 2 e^{-(1-n\pi) i}\right) - \frac{1}{2(1+n\pi) i}\left( \frac 1 2 e^{(1+n\pi)i}+ \frac 1 2 e^{-(1+n\pi) i}\right)\\
&= \frac{1}{2(1-n\pi)}\sin(1-\pi n) + \frac{1}{2(1+n\pi)}\sin(1+\pi n)\\
\end{align*}

Using $c_n$ we can determine $a_n$ and $b_n$

$$
a_0 = \sin 1,\quad a_n = c_n + c_{-n} = \frac{1}{(1-n\pi)}\sin(1-\pi n) + \frac{1}{(1+n\pi)}\sin(1+\pi n)\\, \quad b_n = i(c_n - c_{-n}) = 0
$$

The fourier series in standard and in complex notation are given by:

\begin{align*}
F f(x)&=\sum_{n=-\infty}^{\infty} \left(\frac{1}{2(1-n\pi)}\sin(1-\pi n) + \frac{1}{2(1+n\pi)}\sin(1+\pi n)\right) e^{\frac{2 \pi n x}{T} i}\\
F f(x)&=\sin(1)+\sum_{n=1}^{\infty} \left(  \frac{1}{(1-n\pi) }\sin(1-\pi n) + \frac{1}{(1+n\pi)}\sin(1+\pi n) \right) \cos \left(\pi n x\right)
\end{align*}

%use this command in wolfram "sin(1) + Sum[ (1/(1 - n*pi)*sin(1 - pi*n) + 1/(1 + n*pi)*sin(1 + pi*n))*cos(pi*n*x), {n, 1, 3}]"
We compare $F_3f(x)$ and $f(x)$ at several points 
\begin{align*}
F_3f(0) &= 1.00664,\\
F_3f\left(-\frac{\pi}{4}\right) &= 0.69196,\\
F_3f\left(\frac{\pi}{4}\right) &= 0.69196,\\
\end{align*}

\begin{align*}
f(0) &= 1,\\
f\left(-\frac{\pi}{4}\right) &= 0.70711,\\
f\left(\frac{\pi}{4}\right) &= 0.70711.\\
\end{align*}

\end{solution}



\begin{exercise}
    Compute the Fourier transform of the function
    \begin{gather*}
        f(x) = \left\{\begin{array}{ll}
            x   & \text{ if $0 \leq x < 1$ }
            \\
            0   & \text{ otherwise }
          \end{array}\right.
    \end{gather*}
    You can either directly use the complex exponential, or you can express it in terms of the sine and cosine function. 

    (Interpretation: the function $f(x)$ describes a localized signal: it is zero at $x=0$, then it rises linearly up to $1$, and then it jumps back to zero and remains zero from there on. The signal is not periodic.)
\end{exercise}
\begin{solution}     
    We write down the solution in two different ways, either using the complex exponential directly, or writing it as a sum of sine and cosine.

\begin{align*}
\mathfrak{F}(f)(\alpha)&=\frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} f(x) e^{-i \alpha x} d x\\
&=\frac{1}{\sqrt{2 \pi}} \int_{0}^{1} x e^{-i \alpha x} d x\\
&=\frac{1}{\sqrt{2 \pi}} \left[ \frac{x}{-i\alpha} e^{-i \alpha x} \right]_0^1 + \frac{1}{\sqrt{2 \pi}} \int_{0}^{1} \frac{1}{i\alpha} e^{-i \alpha x} d x\\
&=\frac{1}{\sqrt{2 \pi}} \left[ \frac{x}{-i\alpha} e^{-i \alpha x} \right]_0^1 + \frac{1}{\sqrt{2 \pi}} \left[ \frac{1}{\alpha^2} e^{-
i \alpha x} \right]_{0}^1\\
&=\frac{1}{\sqrt{2 \pi}} \frac{1}{-i\alpha} e^{-i \alpha } + \frac{1}{\sqrt{2 \pi}} \left( \frac{1}{\alpha^2} e^{-i \alpha} -\frac{1}{\alpha^2}\right)\\
&=\frac{1}{\sqrt{2 \pi}}\left( \frac{i}{\alpha} e^{-i \alpha } + \frac{1}{\alpha^2} e^{-i \alpha} -\frac{1}{\alpha^2}\right)\\ 
&=\frac{1}{\sqrt{2 \pi}}\left( \frac{i}{\alpha} \cos\alpha  + \frac{1}{\alpha} \sin\alpha + \frac{1}{\alpha^2} \cos\alpha - \frac{i}{\alpha^2} \sin\alpha -\frac{1}{\alpha^2}\right)\\ 
\end{align*}

Next we do it in terms of sine and cosine functions.
$$
\begin{aligned}
\mathfrak{F}(f)(\alpha)&=\frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} f(x) e^{-i \alpha x} d x\\
&=\frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} f(x)(\cos \alpha x - i\sin\alpha x) d x\\
& = \frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} f(x) \cos\alpha x d x - i\frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} f(x) \sin\alpha x d x
\end{aligned}
$$

We evaluate each integral seperately.

$$\begin{aligned} \int_0^1 x \cos (\alpha x) d x & =\left[\frac{x}{\alpha} \sin \alpha x\right]_0^1-\int_0^1 \frac{1}{\alpha} \sin \alpha x d x \\ & =\left[\frac{x}{\alpha} \sin \alpha x\right]_0^1+\left[\frac{1}{\alpha^2} \cos \alpha x\right]_0^1 \\ & =\frac{1}{\alpha} \sin \alpha+\frac{1}{\alpha^2} \cos \alpha-\frac{1}{\alpha^2}\end{aligned}$$

$$\begin{aligned} \int_0^1 x \sin (\alpha x) d x & =\left[-\frac{x}{\alpha} \cos (\alpha x)\right]_0^1+\int_0^1 \frac{1}{\alpha} \cos (\alpha(x) d x \\ & =\left[-\frac{x}{\alpha} \cos (\alpha x)\right]_0^1+\left[\frac{1}{\alpha^2} \sin \alpha x\right]_0^1 \\ & =-\frac{1}{\alpha} \cos \alpha+\frac{1}{\alpha^2} \sin \alpha\end{aligned}$$

All together we have:
$$
\mathfrak{F}(f)(\alpha)=\frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} f(x) e^{-i \alpha x} d x = \frac{1}{\sqrt{2\pi}}\left(\frac{1}{\alpha} \sin \alpha+\frac{1}{\alpha^2} \cos \alpha-\frac{1}{\alpha^2} +i\frac{1}{\alpha} \cos \alpha-i\frac{1}{\alpha^2} \sin \alpha\right)
$$
\end{solution}

\end{document}
