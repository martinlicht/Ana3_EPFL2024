\documentclass[11pt]{article}
%\def\hidesolutions{}
\input{header}
\begin{document}
\exsheet{10}{21}{November} % parameters are the number of the session and the day

\begin{exercise}
    Use Dirichlet's theorem to explain whether the Fourier series converges at $x \in [0,T]$ and to which value:
    \begin{itemize}
     \item \begin{gather*}
            f(x) = \left\{\begin{array}{ll}
                            x   & \text{ if $0 \leq x < 1$ }
                            \\
                            2 - x & \text{ if $1 \leq x < 2$ }
                          \end{array}\right., \qquad T = 2.
           \end{gather*}
     \item \begin{gather*}
            f(x) = \left\{\begin{array}{ll}
                            \pi   & \text{ if $0 \leq x < 1$ }
                            \\
                            e^{x-1} & \text{ if $1 \leq x < 2$ }
                            \\
                            \sin(x) & \text{ if $2 \leq x < 3$ }
                          \end{array}\right., \qquad T = 3.
           \end{gather*}
    \end{itemize}
    Here, the functions have the given period $T$.
\end{exercise}
\begin{solution}     
\begin{itemize}
\item $f$ is continuous and finite on the closed interval $[0,2]$ therefore the Fourier series, $F_N f$, converges to $f$ when we take the limit of $N$ going to $\infty$.
\item $f$ is continuous and finite on the closed intervals $[0,1]$, $[1,2]$ and $[2,3]$. However note that $f$ is not continuous in $f(0)$, $f(1)$ and $f(2)$ therefore the Fourier series, $F_N f$, converges to: 

\begin{gather*}
            g(x) = \left\{\begin{array}{ll}
                            \frac{\sin(3) + \pi}{2} & \text{ if $x = 0$ }
						\\
                            \pi   & \text{ if $0 < x < 1$ }
                            \\
                            \frac{\pi + 1}{2} & \text{ if $x = 1$ }
						\\
                            e^{x-1} & \text{ if $1 < x < 2$ }
						\\
                            \frac{\sin(2) + e^1}{2} & \text{ if $x = 2$ }
						\\
                            \sin(x) & \text{ if $2 < x < 3$ }
						\\
                            \frac{\sin(3) + \pi}{2} & \text{ if $x = 3$ }
                          \end{array}\right., \qquad T = 3.
\end{gather*}

when we take the limit of $N$ going to $\infty$.
\end{itemize}
\end{solution}

\begin{exercise}
    Give the Fourier series in complex notation, when $f$ has period $T = 2$ and 
    \begin{gather*}
        f(x) = x \text{ for } 0 \leq x < 2.
    \end{gather*}
\end{exercise}
\begin{solution}     
We can re-use the results from Lecture 8 slide 37, the sawtooth wave.

\begin{equation*}
g(x)=x \text { for } 0 \leq x<1
\end{equation*}

\begin{equation*}
a_0^g = \frac{1}{2},\quad a_n^g = 0, \quad b_n^g = \frac{-1}{\pi n}
\end{equation*}

Moreover we can write $f$ in terms of $g$ by introducing $x = \frac{y}{2}$

$$
f(y) = 2g(y/2)
$$

which gives us the fourier coefficients of $f$

\begin{equation*}
a_0^f = 1,\quad a_n^f = 0, \quad b_n^f = \frac{-2}{\pi n}
\end{equation*}

Using this we can obtain the fourier coefficients $c_n$:

$$
c_0 = a_0 = 1,\quad c_n=\frac{a_n}{2}-\frac{b_n}{2} i = \frac{1}{n\pi}i, \quad c_{-n}=\frac{a_n}{2}+\frac{b_n}{2} i = -\frac{1}{n\pi}i
$$

such that 

$$
F f(x)=\sum_{n=-\infty}^{\infty} c_n e^{\pi n x i}
$$
\end{solution}

\begin{exercise}
    Find the Fourier coefficients of $\cos(x)^8$ with period $T = 2\pi$.
    Use Parseval's identity to compute $\int_0^{2\pi} \cos(x)^{16} dx$.
\end{exercise}
\begin{solution}     
We will not use the standard approach in integrating the function $f$. Instead we try to rewrite $f$ as sum of $\cos(nx)$ using trigonometric formulas:
\begin{align*}
\cos^2\alpha &= \frac 1 2 + \frac 1 2 \cos 2 \alpha\\
\cos\alpha\cos\beta &= \frac 1 2 \cos (\alpha-\beta)+ \frac 1 2 \cos (\alpha + \beta) \\
\end{align*}
Using these formulas we can rewrite $f$ as follows:

\begin{align*}
\cos^8x &= (\cos^2x)^4\\
&= (\frac 1 2 + \frac 1 2 \cos 2x)^4\\
&= ((\frac 1 2 + \frac 1 2 \cos 2x)^2)^2\\
&= (\frac 1 4 + \frac 1 2 \cos 2x + \frac 1 4 \cos ^2 2 x)^2\\
&= (\frac 1 4 + \frac 1 2 \cos 2x + \frac 1 4 \cos ^2 2 x)^2\\
&= (\frac 1 4 + \frac 1 2 \cos 2x + \frac 1 4 \cos ^2 2x)(\frac 1 4 + \frac 1 2 \cos 2x + \frac 1 4 \cos ^2 2x)\\
&= \frac{1}{16}+\frac 1 4 \cos 2x + \frac 3 8 \cos^2 2x + \frac 1 4 \cos^3 2x +\frac{1}{16} \cos^4 2x\\
&= \frac{1}{16}+\frac 1 4 \cos 2x + \frac 3 8 (\frac 1 2 + \frac 1 2 \cos 4x) + \frac 1 4 \cos^3 2x +\frac{1}{16} \cos^4 2x\\
&= \frac{4}{16}+\frac 1 4 \cos 2x + \frac{3}{16} \cos 4x + \frac 1 4 \cos^3 2x +\frac{1}{16} \cos^4 2x\\
\end{align*}

Now we consider $\cos^3 2x$ and $\cos^4 2x$ seperately:

\begin{align*}
\cos^3 2x &= \cos 2x \cos^2 2x\\
&= (\frac 1 2 + \frac 1 2 \cos 4x) \cos 2x\\
&= \frac 1 2 \cos 2x + \frac 1 2 \cos 4 x \cos 2 x \\
&= \frac 1 2 \cos 2x + \frac 1 4 \cos 6 x  + \frac 1 4 \cos 2 x \\
&= \frac 3 4 \cos 2x + \frac 1 4 \cos 6 x \\
\end{align*}

\begin{align*}
\cos^4 2x &= (\cos^2 2x)^2\\
&=(\frac 1 2 + \frac 1 2 \cos 4x)^2\\
&= \frac 1 4 + \frac 1 2 \cos 4x + \frac 1 4 \cos^2 4x\\
&= \frac 1 4 + \frac 1 2 \cos 4x + \frac 1 4 (\frac 1 2 + \frac 1 2 \cos 8x)\\
&= \frac 3 8 + \frac 1 2 \cos 4x + \frac 1 8 \cos 8x\\
\end{align*}

putting everything together we have:

$$
\cos^8x  = \frac{35}{128} + \frac{7}{16}\cos 2x + \frac{7}{32}\cos 4x + \frac{1}{16} \cos 6x + \frac{1}{128}\cos 8x
$$

For the second part we use Parseval's identity which is given by: 

$$
\frac{2}{T} \int_0^T f(x)^2 d x=2 a_0^2+\sum_{n=0}^{\infty}\left(a_n\right)^2+\left(b_n\right)^2
$$

substituting our fourier coefficients and $f$ gives: 

\begin{align*}
\frac{2}{T} \int_0^T f(x)^2 d x&=2 a_0+\sum_{n=0}^{\infty}\left(a_n\right)^2+\left(b_n\right)^2\\
\frac{1}{\pi} \int_0^{2\pi} \cos(x)^{16} d x&= 2\left(\frac{35}{128}\right)^2 + \left(\frac{7}{16}\right)^2 + \left(\frac{7}{32}\right)^2 + \left(\frac{1}{16}\right)^2 + \left(\frac{1}{128}\right)^2.\\
\implies \int_0^{2\pi} \cos(x)^{16} d x&= \pi\left(2\left(\frac{35}{128}\right)^2 + \left(\frac{7}{16}\right)^2 + \left(\frac{7}{32}\right)^2 + \left(\frac{1}{16}\right)^2 + \left(\frac{1}{128}\right)^2\right) = \pi\frac 6435 16384 \approx 1.2339\\
\end{align*}

\end{solution}

\begin{exercise}
    Give the Fourier series of the function $f$ with period $T = 2$ and 
    \begin{gather*}
        f(x) = \cos(x) \text{ for } -1 \leq x < 1.
    \end{gather*}
    Give the Fourier series in standard form and in complex notation. 
    Compare $F_3 f$ at the points $x = -\pi/4, 0, \pi/4$.
\end{exercise}
\begin{solution}    
We calculate the complex fourier coefficients 
\begin{align*}
c_0 = \frac 1 2 \int_{-1}^1 \cos x dx = \frac 1 2 [\sin x]_{-1}^1 = \sin 1
\end{align*}

\begin{align*}
c_n &= \frac 1 2 \int_{-1}^1 \cos x e^{-\pi n x i} dx\\
&= \frac 1 2 \int_{-1}^1 \left(\frac 1 2 e^{x i} + \frac 1 2 e^{-x i} \right) e^{-\pi n x i} dx\\
&= \frac 1 2 \int_{-1}^1 \left(\frac 1 2 e^{(1-n\pi)x i} + \frac 1 2 e^{-(1+n\pi)x i} \right) dx\\
&= \frac 1 2\left[\frac{1}{(1-n\pi) i}\frac 1 2 e^{(1-n\pi)x i} - \frac{1}{(1+n\pi) i}\frac 1 2 e^{-(1+n\pi)x i} \right]_{-1}^1\\
&= \frac{1}{2(1-n\pi) i}\left( \frac 1 2 e^{(1-n\pi)i}- \frac 1 2 e^{-(1-n\pi) i}\right) - \frac{1}{2(1+n\pi) i}\left( \frac 1 2 e^{(1+n\pi)i}+ \frac 1 2 e^{-(1+n\pi) i}\right)\\
&= \frac{1}{2(1-n\pi)}\sin(1-\pi n) + \frac{1}{2(1+n\pi)}\sin(1+\pi n)\\
\end{align*}

Using $c_n$ we can determine $a_n$ and $b_n$

$$
a_0 = \sin 1,\quad a_n = c_n + c_{-n} = \frac{1}{(1-n\pi)}\sin(1-\pi n) + \frac{1}{(1+n\pi)}\sin(1+\pi n)\\, \quad b_n = i(c_n - c_{-n}) = 0
$$

The fourier series in standard and in complex notation are given by:

\begin{align*}
F f(x)&=\sum_{n=-\infty}^{\infty} \left(\frac{1}{2(1-n\pi)}\sin(1-\pi n) + \frac{1}{2(1+n\pi)}\sin(1+\pi n)\right) e^{\frac{2 \pi n x}{T} i}\\
F f(x)&=\sin(1)+\sum_{n=1}^{\infty} \left(  \frac{1}{(1-n\pi) }\sin(1-\pi n) + \frac{1}{(1+n\pi)}\sin(1+\pi n) \right) \cos \left(\pi n x\right)
\end{align*}

%use this command in wolfram "sin(1) + Sum[ (1/(1 - n*pi)*sin(1 - pi*n) + 1/(1 + n*pi)*sin(1 + pi*n))*cos(pi*n*x), {n, 1, 3}]"
We compare $F_3f(x)$ and $f(x)$ at several points 
\begin{align*}
F_3f(0) &= 1.00664,\\
F_3f\left(-\frac{\pi}{4}\right) &= 0.69196,\\
F_3f\left(\frac{\pi}{4}\right) &= 0.69196,\\
\end{align*}

\begin{align*}
f(0) &= 1,\\
f\left(-\frac{\pi}{4}\right) &= 0.70711,\\
f\left(\frac{\pi}{4}\right) &= 0.70711.\\
\end{align*}

\end{solution}



\begin{exercise}
    Compute the Fourier transform of the function
    \begin{gather*}
        f(x) = \left\{\begin{array}{ll}
            x   & \text{ if $0 \leq x < 1$ }
            \\
            0   & \text{ otherwise }
          \end{array}\right.
    \end{gather*}
    You can either directly use the complex exponential, or you can express it in terms of the sine and cosine function. 

    (Interpretation: the function $f(x)$ describes a localized signal: it is zero at $x=0$, then it rises linearly up to $1$, and then it jumps back to zero and remains zero from there on. The signal is not periodic.)
\end{exercise}
\begin{solution}     
    We write down the solution in two different ways, either using the complex exponential directly, or writing it as a sum of sine and cosine.

\begin{align*}
\mathfrak{F}(f)(\alpha)&=\frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} f(x) e^{-i \alpha x} d x\\
&=\frac{1}{\sqrt{2 \pi}} \int_{0}^{1} x e^{-i \alpha x} d x\\
&=\frac{1}{\sqrt{2 \pi}} \left[ \frac{x}{-i\alpha} e^{-i \alpha x} \right]_0^1 + \frac{1}{\sqrt{2 \pi}} \int_{0}^{1} \frac{1}{i\alpha} e^{-i \alpha x} d x\\
&=\frac{1}{\sqrt{2 \pi}} \left[ \frac{x}{-i\alpha} e^{-i \alpha x} \right]_0^1 + \frac{1}{\sqrt{2 \pi}} \left[ \frac{1}{\alpha^2} e^{-
i \alpha x} \right]_{0}^1\\
&=\frac{1}{\sqrt{2 \pi}} \frac{1}{-i\alpha} e^{-i \alpha } + \frac{1}{\sqrt{2 \pi}} \left( \frac{1}{\alpha^2} e^{-i \alpha} -\frac{1}{\alpha^2}\right)\\
&=\frac{1}{\sqrt{2 \pi}}\left( \frac{i}{\alpha} e^{-i \alpha } + \frac{1}{\alpha^2} e^{-i \alpha} -\frac{1}{\alpha^2}\right)\\ 
&=\frac{1}{\sqrt{2 \pi}}\left( \frac{i}{\alpha} \cos\alpha  + \frac{1}{\alpha} \sin\alpha + \frac{1}{\alpha^2} \cos\alpha - \frac{i}{\alpha^2} \sin\alpha -\frac{1}{\alpha^2}\right)\\ 
\end{align*}

Next we do it in terms of sine and cosine functions.
$$
\begin{aligned}
\mathfrak{F}(f)(\alpha)&=\frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} f(x) e^{-i \alpha x} d x\\
&=\frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} f(x)(\cos \alpha x - i\sin\alpha x) d x\\
& = \frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} f(x) \cos\alpha x d x - i\frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} f(x) \sin\alpha x d x
\end{aligned}
$$

We evaluate each integral seperately.

$$\begin{aligned} \int_0^1 x \cos (\alpha x) d x & =\left[\frac{x}{\alpha} \sin \alpha x\right]_0^1-\int_0^1 \frac{1}{\alpha} \sin \alpha x d x \\ & =\left[\frac{x}{\alpha} \sin \alpha x\right]_0^1+\left[\frac{1}{\alpha^2} \cos \alpha x\right]_0^1 \\ & =\frac{1}{\alpha} \sin \alpha+\frac{1}{\alpha^2} \cos \alpha-\frac{1}{\alpha^2}\end{aligned}$$

$$\begin{aligned} \int_0^1 x \sin (\alpha x) d x & =\left[-\frac{x}{\alpha} \cos (\alpha x)\right]_0^1+\int_0^1 \frac{1}{\alpha} \cos (\alpha(x) d x \\ & =\left[-\frac{x}{\alpha} \cos (\alpha x)\right]_0^1+\left[\frac{1}{\alpha^2} \sin \alpha x\right]_0^1 \\ & =-\frac{1}{\alpha} \cos \alpha+\frac{1}{\alpha^2} \sin \alpha\end{aligned}$$

All together we have:
$$
\mathfrak{F}(f)(\alpha)=\frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} f(x) e^{-i \alpha x} d x = \frac{1}{\sqrt{2\pi}}\left(\frac{1}{\alpha} \sin \alpha+\frac{1}{\alpha^2} \cos \alpha-\frac{1}{\alpha^2} +i\frac{1}{\alpha} \cos \alpha-i\frac{1}{\alpha^2} \sin \alpha\right)
$$
\end{solution}

\end{document}
